
var total_ssids_added=0;var security_method;var tx_slider_initialized=false;var max_list=128;var max_Pairlist=5;var channel_id='';var max_list_walled=32;function popupWindow(url){var win=window.open(url,'popupWindow','toolbar=no,location=no,directories=no,status=no,bar=no,scrollbars=no,resizable=yes,copyhistory=no,width=850,height=590,screenX=100,screenY=0,top=0,left=100');win.focus();}
function set_ssid_defaults(id){var radio_idx=radio_iface+'_'+id;$('#cbid\\.wireless\\.'+radio_idx+'\\.disabled').val('0');$('#cbid\\.wireless\\.'+radio_idx+'\\.disabled').attr('checked','checked');$('#cbid\\.wireless\\.'+radio_idx+'\\.ssid').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\._wpa_key').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.encryption').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior option').removeAttr('selected');$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior').val('route');}
function scan(){var radio_idx=radio_iface+'_1';$('#spinner_scan').addClass('icon-spin');$('#spinner_scan_container').show();var showJoin='';$('#scan_results').html('');if($('#cbid\\.wireless\\.'+radio_iface+'\\.mode').val().indexOf('sta')>=0){showJoin='show_join';}
$.get(scan_url+'/'+showJoin,null,function(data){if(data.search('<form method="post" name="login"')!=-1){top.location.href=ssid_url;return;}
$('#scan_results').html(data);$('#spinner_scan').removeClass('icon-spin');$('#spinner_scan_container').hide();$('.join-btn').click(function(){$('#wifi_scan_modal').modal('hide');var security=$(this).attr('data-security');var suites=$(this).attr('data-suites');if(suites==undefined){suites='';}
if(security==undefined){security='';}
suites=suites.toLowerCase();security=security.toLowerCase();$('#cbid\\.wireless\\.'+radio_idx+'\\.ssid').val($(this).attr('data-ssid'));$('#cbid\\.wireless\\.'+radio_idx+'\\.encryption option').removeAttr('selected');if(suites.indexOf('802.1x')>=0&&security.indexOf('wpa2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2').prop('selected','selected');}else if(suites.indexOf('802.1x')>=0&&security.indexOf('wpa')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa').prop('selected','selected');}else if(security.indexOf('wpa2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-psk2').prop('selected','selected');}else if(security.indexOf('wpa')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-psk').prop('selected','selected');}else if(security.indexOf('wep')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-wep-open').prop('selected','selected');}else{$('#cbi-wireless-'+radio_idx+'-encryption-none').prop('selected','selected');}
$('#cbid\\.wireless\\.'+radio_idx+'\\.cipher option').removeAttr('seleted');if(suites.indexOf('802.x')<0&&suites.indexOf('ccmp')){$('#cbi-wireless-'+radio_idx+'-cipher-ccmp').prop('selected','selected');}
cbi_d_update('cbid.wireless.'+radio_iface+'_1.encryption');cbi_d_update('cbid.wireless.'+radio_iface+'_1.cipher');});});}
var aiming_timeout_id='';var ori_aiming_mode='';var aiming_stop_Tid=-1;function send_aiming_request(){var mode_select=$('#aiming_mode').val();if(ori_aiming_mode!=mode_select){$('#aiming_scan_results').html('');$('#spinner_aiming_container').show();}else{$('#spinner_aiming_container').hide();}
var api=(mode_select=='0')?aiming_tx_api_url:aiming_rx_api_url;$.getJSON(api,{},function(data){$('#spinner_aiming_container').hide();if(aiming_stop_Tid>=0&&aiming_timeout_id>=aiming_stop_Tid){return;}
if(data==''){$('#aiming_scan_results').html('No Data');}else{$('#aiming_scan_results').html(data+' dBm');}
ori_aiming_mode=mode_select;aiming_timeout_id=setTimeout(send_aiming_request,1*1000);});}
function add_ssid(){if($('#btn_add_ssid').attr('disabled')=='disabled'){return;}
$('#btn_add_ssid').attr('disabled','disabled');$('#btn_save').attr('disabled','disabled');var next_id=total_ssids_added+1;var next_section_id;for(i=1;i<=max_ssids;i++){var id_to_check='#cbid\\.wireless\\.'+radio_iface+'_'+i+'\\.disabled';if($(id_to_check).length==0){next_section_id=i;break;}}
$('#ssid_tabs li').removeClass('active');$('#ssidTabContent .tab-pane').removeClass('active');var ssid_tab_container='<li id=\'SSID_tab_'+next_id
+'\' class=\'active\' data-ssidid=\''+next_id+'\'>'
+'<a data-toggle=\'tab\' href=\'#SSID'+next_id
+'\'>SSID'+next_id+'</a></li>';$('#last_ssid').before(ssid_tab_container);var ssid_content_container='<div id="SSID'+next_id+'" class="tab-pane active">'
+'<div class="spinner-container'+next_id+'">'
+' <i class="icon-spinner icon-spin" id="spinner'+next_id+'"></i> &nbsp;&nbsp;Loading... '
+'</div>';'</div>';if(next_id==1){$('#ssidTabContent').html('');}
$('#ssidTabContent').append(ssid_content_container);active_id=next_id;var radio_idx=radio_iface+'_'+next_section_id;$.get(ssid_url+'/'+next_section_id,null,function(data){if(data.search('<form method="post" name="login"')!=-1){top.location.href=ssid_url;return;}
$('#SSID'+next_id).append(data);$('#spinner'+next_id).removeClass('icon-spin');$('.spinner-container'+next_id).hide();$('#SSID_tab_'+next_id).click(function(){var tmp_arr=(this.id).split('_');site_entity_control(tmp_arr[2]);});set_ssid_defaults(next_section_id);try{cbi_d_update('cbid.wireless.'+radio_idx+'.disabled');}catch(ex){}
var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';encry_change(next_section_id);$(encryption_id).change(function(){encry_change(next_section_id);});var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';network_behavior_change(radio_idx);$(network_behavior_id).change(function(){network_behavior_change(radio_idx);});var limit_up_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';limit_enable_change(next_section_id);$(limit_up_enable_id).change(function(){limit_enable_change(next_section_id);});var limit_down_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';limit_enable_change(next_section_id);$(limit_down_enable_id).change(function(){limit_enable_change(next_section_id);});var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';$(radius_mac_acl_id).change(function(){radius_mac_acl_change($(radius_mac_acl_id).is(':checked'),next_section_id);});var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_auth_enable2';$(radius_auth_backup_enable_id).change(function(){radius_auth_backup_enable_change($(radius_auth_backup_enable_id).is(':checked'),next_section_id);});var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';$(dae_enable_id).change(function(){radius_dae_enable_change($(dae_enable_id).is(':checked'),next_section_id);});var radius_acct_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable';$(radius_acct_enable_id).change(function(){radius_acct_enable_change($(radius_acct_enable_id).is(':checked'),next_section_id);});var radius_acct_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';$(radius_acct_backup_enable_id).change(function(){radius_acct_backup_enable_change($(radius_acct_backup_enable_id).is(':checked'),next_section_id);});var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';$(auth_server_id).change(function(){clear_validate_error(auth_server_id);});$(auth_port_id).change(function(){clear_validate_error(auth_port_id);});$(auth_secret_id).change(function(){clear_validate_error(auth_secret_id);});total_ssids_added++;set_btn_state();change_opmode();change_hwmode();});}
var active_id=1;function renumber_ssids(ssid_id){var last=true;for(i=ssid_id+1;i<=total_ssids_added;i++){if((i-1)<1){return;}
last=false;var old_tab_id='#SSID_tab_'+i;var old_tab_ssid=$(old_tab_id+' span').text();var new_tab_id='SSID_tab_'+(i-1);$('#SSID_tab_'+i).attr('id',new_tab_id);$('#'+new_tab_id).attr('data-ssidid',(i-1));$('#SSID'+i).attr('id','SSID'+(i-1));$('#'+new_tab_id+' a').attr('href','#SSID'+(i-1));var ssid_tab_html='<span>'+old_tab_ssid+'</span>&nbsp;(SSID'+(i-1)+')';$('#'+new_tab_id+' a').html(ssid_tab_html);sitelevel_ssid_status[i-2]=sitelevel_ssid_status[i-1];}
active_id=ssid_id;if(last){active_id=ssid_id-1;}
$('#SSID_tab_'+(active_id)).addClass('active');$('#SSID'+(active_id)).addClass('active');}
function remove_ssid(){if($('#btn_remove_ssid').attr('disabled')=='disabled'){return;}
var ssid_id=$('#ssid_tabs li.active').first().data('ssidid');$('#SSID'+ssid_id).remove();$('#SSID_tab_'+ssid_id).remove();renumber_ssids(ssid_id);total_ssids_added--;set_btn_state();}
function site_entity_control(idx){if(sitelevel_ssid_status[idx-1]!=''){$('#btn_remove_ssid').attr('disabled','disabled');$('#btn_remove_ssid').attr('data-original-title','This item is managed by the cloud and cannot be deleted. Please disable it instead.');}else{if(total_ssids_added>1){$('#btn_remove_ssid').removeAttr('disabled');$('#btn_remove_ssid').attr('data-original-title','Remove selected SSID');}}}
function set_btn_state(last_entity_idx){if(total_ssids_added<max_ssids){$('#btn_add_ssid').removeAttr('disabled');}else{$('#btn_add_ssid').attr('disabled','disabled');}
if(total_ssids_added<=1){$('#btn_remove_ssid').attr('disabled','disabled');}else{$('#btn_remove_ssid').removeAttr('disabled');}
$('#btn_save').removeAttr('disabled');site_entity_control(active_id);}
function disabled_items(radio_idx,vap_idx,flag){var radio_idx=radio_iface+'_'+vap_idx;if(mgmt_enabled){var pre_id='#cbid\\.wireless\\.'+radio_idx+'\\.';var change_items=new Array('disabled','ssid','hidden','nasid','isolate','wmm_enable','blockmcast','maxsta','min_signal_allowed','encryption','key1','cipher','_wpa_key','pmf','u8021p','ieee80211r','mobility_domain','kh_key_hex','ft_over_ds','Pairlist','auth_server','auth_port','auth_secret','acct_enable','acct_server','acct_port','acct_secret','acct_interval','acct_enable2','acct_server2','acct_port2','acct_secret2','eap_type','identity','password','macfilter_enable','macfilter','maclist','limit_up_enable','limit_up','limit_down_enable','limit_down','network_behavior','vlan_network_name','network_name','dae_enable','dae_port','dae_secret','dae_client','radius_auth_enable2','auth_server2','auth_port2','auth_secret2','radius_mac_acl','cloud_aaa','proxyarp','internet','mcast_rate','hs20','access_network_type','venue_group','venue_name','venue_type','roaming_consortium','ipaddr_type_availability_ipv4','ipaddr_type_availability_ipv6','nai_realm','domain_name','anqp_3gpp_cell_net','hs20_r2_enable','osu_ssid','osu_server_uri','osu_nai','osu_friendly_name','osu_service_desc','osen');if(flag=='ap'){$('#ssid_action_buttons').addClass('hidden');$('#wifi_mgmt_notify_'+radio_idx).removeClass('hidden');$('#scan_btn_'+radio_idx).attr('disabled','disabled');$('#cbi-wireless-'+radio_idx+'-wallgardenbtn').attr('disabled','disabled');$('#hotspot_configure_btn_'+radio_idx).attr('disabled','disabled');for(var i=0;i<change_items.length;i++){$(pre_id+change_items[i]).attr('disabled','disabled');$(pre_id+change_items[i]).attr('style','background-color:#eee');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').attr('disabled','disabled');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').attr('style','background-color:#eee');$('.btn-dynamic').removeAttr('style').hide();}}else{$('#ssid_action_buttons').removeClass('hidden');$('#wifi_mgmt_notify_'+radio_idx).addClass('hidden');$('#scan_btn_'+radio_idx).removeAttr('disabled');$('#cbi-wireless-'+radio_idx+'-wallgardenbtn').removeAttr('disabled');$('#hotspot_configure_btn_'+radio_idx).removeAttr('disabled');for(var i=0;i<change_items.length;i++){$(pre_id+change_items[i]).removeAttr('disabled');$(pre_id+change_items[i]).removeAttr('style');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').removeAttr('disabled');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').removeAttr('style');$('.btn-dynamic').show();}}}}
function change_opmode(){var radio_idx=radio_iface+'_1';var cipher_id='#cbid\\.wireless\\.'+radio_idx+'\\.cipher';var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var htmode_id=document.getElementById('cbid.wireless.'+radio_iface+'.htmode');var tkip_aes_option_id='cbi-wireless-'+radio_idx+'-cipher-tkip\\+ccmp';var macfilter_enabled_id='#cbi-wireless-'+radio_idx+'-macfilter_enable';var maclist_id='#cbi-wireless-'+radio_idx+'-maclist';var cli_isolation_id='#cbi-wireless-'+radio_idx+'-client_isolation';var tkip_aes_option='<option id="cbi-wireless-'+radio_idx+'-cipher-tkip+ccmp" value="tkip+ccmp">Auto: TKIP + CCMP (AES)</option>';var wep_option_id='cbi-wireless-'+radio_idx+'-encryption-wep-open';var wep_option='<option id="cbi-wireless-'+radio_idx+'-encryption-wep-open" value="wep-open">WEP Open System</option>';var current_cipher=$(cipher_id).val();var current_encryption=$(encryption_id).val();var op_mode=$(mode_id).val();var ht_mode=$(htmode_id).val();if(op_mode.indexOf('sta')<0){$('#'+radio_idx+'_sta_non_wds_bridge_notify').addClass('hidden');if(ht_mode=='40'){$('#cbi-wireless-'+radio_iface+'-disablecoext').show();}else{$('#cbi-wireless-'+radio_iface+'-disablecoext').hide();}
$('#cbi-wireless-'+radio_iface+'-bandsteering').show();$('#cbi-wireless-'+radio_iface+'-prc_disabled').show();$('#cbi-wireless-'+radio_iface+'-prc_remote_url').show();$('#cbi-wireless-'+radio_idx+'-min_signal_allowed').show();$('#cbi-wireless-'+radio_idx+'-maxsta').show();if(bandsteering_allowed){$('#cbid\\.wireless\\.'+radio_iface+'\\.bandsteering').removeAttr('disabled');}else{$('#cbid\\.wireless\\.'+radio_iface+'\\.bandsteering').attr('disabled','disabled');}
if(country_code=='OT'){$('#cbi-wireless-'+radio_iface+'-dfs').show();}else{$('#cbi-wireless-'+radio_iface+'-dfs').hide();}
$('#cbi-wireless-'+radio_idx+'-disabled').hide();if(has_ssid_status){$('#cbi-wireless-'+radio_idx+'-disabled').show();}
$('#ssidTabContent').css('background-color','white');$('#ssidTabContent').css('border','1px solid rgb(202, 202, 202)');if(!ssid_only_one){$('#ssid_tabs').show();$('#ssid_tabs').removeClass('hidden');$('#ssid_action_buttons').removeClass('hidden');}
$('#wireless_title').parent().css('margin-bottom','20px');$('.broadcast-checkbox').show();if(has_network_behavior){$('#cbi-wireless-'+radio_idx+'-network_behavior').removeClass('hidden');}else{$('#cbi-wireless-'+radio_idx+'-network_behavior').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-network_name').css('display','none');}
$('#'+radio_idx+'_wan_notify').addClass('hidden');$('#'+radio_idx+'_wan_change_notify').addClass('hidden');$('#'+radio_idx+'_wan_sta_notify').addClass('hidden');$('#'+radio_idx+'_reset_inet_src').val('0');$('#'+radio_idx+'_set_inet_src').val('0');var status_id=document.getElementById('cbid.wireless.'+radio_iface+'.disabled');if($(status_id).is(':checked')){if($('#'+radio_idx+'_wan_notify').attr('id')!=null){$('#'+radio_idx+'_wan_change_notify').removeClass('hidden');$('#'+radio_idx+'_reset_inet_src').val('1');}}
$(macfilter_enabled_id).show();$(cli_isolation_id).show();security_method=$(encryption_id).val();var staWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa');var staWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2');var apWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa');var apWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa2');if(staWpaOption.length!=0){staWpaOption.remove();}
if(staWpa2Option.length!=0){staWpa2Option.remove();}
if(apWpaOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-ap-wpa',value:'ap-wpa'}).text('WPA-EAP'));}
if(apWpa2Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-ap-wpa2',value:'ap-wpa2'}).text('WPA2-EAP'));}
if(security_method!=undefined){if(security_method.indexOf('ap-wpa2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa2').attr('selected','selected');}else if(security_method.indexOf('ap-wpa')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa').attr('selected','selected');}else if(security_method.indexOf('sta-wpa2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa2').attr('selected','selected');}else if(security_method.indexOf('sta-wpa')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa').attr('selected','selected');}else if(security_method.indexOf('psk2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-psk2').attr('selected','selected');}else if(security_method.indexOf('psk')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-psk').attr('selected','selected');}else if(security_method.indexOf('wep')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-wep-open').attr('selected','selected');}else{$('#cbi-wireless-'+radio_idx+'-encryption-none').attr('selected','selected');}}
$('#cbi-wireless-'+radio_iface+'-_channel').show();$('#'+channel_id).prop('disabled',false);for(i=1;i<=max_ssids;i++){disabled_items(radio_id,i,'ap');$('#scan_btn_'+radio_iface+'_'+i).val('Site Survey');var staWpaOption=$('#cbi-wireless-'+radio_iface+'_'+i+'-encryption-sta-wpa');var staWpa2Option=$('#cbi-wireless-'+radio_iface+'_'+i+'-encryption-sta-wpa2');if(staWpaOption.length!=0){staWpaOption.remove();}
if(staWpa2Option.length!=0){staWpa2Option.remove();}
encry_change(i);}}else{for(i=1;i<=max_ssids;i++){disabled_items(radio_id,i,'sta_mode');}
if(op_mode=='sta'&&wan_is_eth){$('#'+radio_idx+'_sta_non_wds_bridge_notify').removeClass('hidden');}else{$('#'+radio_idx+'_sta_non_wds_bridge_notify').addClass('hidden');}
$('#scan_btn_'+radio_idx+'').val('Scan');$('#cbi-wireless-'+radio_iface+'-prc_disabled').hide();$('#cbi-wireless-'+radio_iface+'-prc_remote_url').hide();$('#cbi-wireless-'+radio_iface+'-bandsteering').hide();$('#cbi-wireless-'+radio_iface+'-disablecoext').hide();$('#cbi-wireless-'+radio_idx+'-min_signal_allowed').hide();$('#cbi-wireless-'+radio_idx+'-maxsta').hide();$('#cbid\\.wireless\\.'+radio_idx+'\\.min_signal_allowed').val('0');$('#cbi-wireless-'+radio_iface+'-dfs').hide();$('#cbi-wireless-'+radio_idx+'-disabled').hide();$('#cbid\\.wireless\\.'+radio_idx+'\\.disabled').prop('indeterminate',false).prop('checked',true);$('#ssidTabContent').children('div.tab-pane').removeClass('active');$('#ssidTabContent').children('div.tab-pane').first().addClass('active');$('#ssidTabContent').css('background-color','inherit');$('#wireless_title').text(client_config);$('#ssid_tabs').hide();$('#ssid_action_buttons').addClass('hidden');$('#wireless_title').parent().css('margin-bottom','0px');$('#ssidTabContent').css('border','0px solid rgb(202, 202, 202)');security_method=$(encryption_id).val();var staWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa');var staWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2');var apWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa');var apWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-ap-wpa2');if(apWpaOption.length!=0){apWpaOption.remove();}
if(apWpa2Option.length!=0){apWpa2Option.remove();}
if(staWpaOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-sta-wpa',value:'sta-wpa'}).text('WPA-EAP'));}
if(staWpa2Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-sta-wpa2',value:'sta-wpa2'}).text('WPA2-EAP'));}
if(security_method!=undefined){if(security_method.indexOf('ap-wpa2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2').attr('selected','selected');}else if(security_method.indexOf('ap-wpa')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa').attr('selected','selected');}else if(security_method.indexOf('sta-wpa2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2').attr('selected','selected');}else if(security_method.indexOf('sta-wpa')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa').attr('selected','selected');}else if(security_method.indexOf('psk2')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-psk2').attr('selected','selected');}else if(security_method.indexOf('psk')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-psk').attr('selected','selected');}else if(security_method.indexOf('wep')>=0){$('#cbi-wireless-'+radio_idx+'-encryption-wep-open').attr('selected','selected');}else{$('#cbi-wireless-'+radio_idx+'-encryption-none').attr('selected','selected');}}
$('.broadcast-checkbox').hide();$('#'+radio_idx+'_wan_notify').removeClass('hidden');$('#'+radio_idx+'_wan_change_notify').addClass('hidden');$('#'+radio_idx+'_reset_inet_src').val('0');$('#'+radio_idx+'_set_inet_src').val('0');if(previous_opmode.indexOf('sta')<0){var status_id=document.getElementById('cbid.wireless.'+radio_iface+'.disabled');if($(status_id).is(':checked')){$('#'+radio_idx+'_wan_sta_notify').removeClass('hidden');$('#'+radio_idx+'_set_inet_src').val('1');}
$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior').val('wan');$('#cbi-wireless-'+radio_idx+'-network_behavior').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-network_name').css('display','none');}
if(!has_network_behavior||($('#'+radio_idx+'_wan_notify').attr('id')!=null)){$('#cbi-wireless-'+radio_idx+'-network_behavior').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-network_name').css('display','none');}
$(macfilter_enabled_id).hide();$(maclist_id).hide();$(cli_isolation_id).hide();radius_change('hide','1');$('#cbi-wireless-'+radio_iface+'-_channel').hide();$('#'+channel_id).prop('disabled',true);}
$('#'+tkip_aes_option_id).remove();$('#'+wep_option_id).remove();if(op_mode!='sta-wds'&&op_mode!='sta-wds-ptp'){$(encryption_id).append(wep_option);}
{$(cipher_id).append(tkip_aes_option);$(encryption_id).val(current_encryption);$(cipher_id).val(current_cipher);}
cbi_d_update('cbid.wireless.'+radio_idx+'.encryption');}
function set_ack_distance(){var time=$('#cbid\\.wireless\\.'+radio_iface+'\\.ack').val();if(time==null||time==undefined||time==0){$('#ack_miles').html(0);$('#ack_km').html(0);return;}
if(time<32||time>255){return;}
var km=(time-25)/6.7;var miles=km*0.621371192;$('#ack_miles').html(Math.round(miles*10)/10);$('#ack_km').html(Math.round(km*10)/10);}
function validate_network_behavior(radio_idx){var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';if($(network_behavior_id).val()=='wan'&&wan_proto=='3g'&&$('#'+radio_idx+'_set_inet_src').val()!='1'&&$('#'+radio_iface+'_1_set_inet_src').val()!='1'){return false;}
return true;}
function network_behavior_change(radio_idx){var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var bridge_error_alert='#'+radio_idx+'_wan_bridge_iface_error';var err_msg='This network behavior cannot be selected.';if($(network_behavior_id).val()=='wan'){if(wan_proto=='3g'&&$('#'+radio_idx+'_set_inet_src').val()!='1'&&$('#'+radio_iface+'_1_set_inet_src').val()!='1'){set_err_msg(network_behavior_id,true,err_msg);$(bridge_error_alert).removeClass('hidden');}else{set_err_msg(network_behavior_id,false,err_msg);$(bridge_error_alert).addClass('hidden');}}else{set_err_msg(network_behavior_id,false,err_msg);$(bridge_error_alert).addClass('hidden');}}
function limit_enable_change(vap_id){var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var op_mode=$(mode_id).val();if(op_mode.indexOf('sta')<0){disabled_items(radio_id,vap_id,'ap');}else{disabled_items(radio_id,vap_id,'sta_mode');}}
function encry_change(ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var dynamic_option_id='cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan';var dynamic_option='<option id="cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan" value="dynamic_vlan">Dynamic VLAN</option>';var dae_enable_id=$('#cbi-wireless-'+radio_idx+'-dae_enable');var val=$(encryption_id).val();var nbh_val=$(network_behavior_id).val();$('#'+dynamic_option_id).remove();var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var op_mode=$(mode_id).val();if(op_mode.indexOf('sta')<0){disabled_items(radio_id,ssid_id,'ap');if(val=='ap-wpa'||val=='ap-wpa2'){var radius_mac_acl_row_id='#cbi-wireless-'+radio_idx+'-radius_mac_acl';$(radius_mac_acl_row_id).hide();dae_enable_id.show();radius_dae_enable_change(true,ssid_id);$('#cbi-wireless-'+radio_idx+'-auth_server').show();$('#cbi-wireless-'+radio_idx+'-auth_port').show();$('#cbi-wireless-'+radio_idx+'-auth_secret').show();$(network_behavior_id).append(dynamic_option);}
radius_change('show',ssid_id);$(network_behavior_id).val(nbh_val);}else{disabled_items(radio_id,ssid_id,'sta_mode');radius_change('hide',ssid_id);}
$(encryption_id).val(val);}
var CH_40m=new Array(36,44,52,60,68,76,84,92,100,108,116,124,132,140,149,157,165,173);var CH_80m=new Array(36,52,68,84,100,116,132,149,165,179);var chnl_list_ori=[];var chnl_list=[];var removed_channel=[];function get_channel_arr(_arr){$('#'+channel_id+' option').each(function(){if($.isNumeric(this.value)){_arr.push(this.value);}});}
function is80MChannel(chnl_list,chnl_num,channel){var idx;var chNO;var baseCH=0,MAX_NUM_80M_CH=CH_80m.length;if((CH_80m[MAX_NUM_80M_CH-1]<=channel)&&((CH_80m[MAX_NUM_80M_CH-1]+8)>=channel)){baseCH=CH_80m[MAX_NUM_80M_CH-1];}else{for(chNO=0;chNO<MAX_NUM_80M_CH-1;chNO++){if(CH_80m[chNO]<=channel&&CH_80m[chNO+1]>channel){baseCH=CH_80m[chNO];break;}}}
if(baseCH===0){}
for(idx=0;idx<chnl_num;idx++){if(chnl_list[idx]==baseCH){break;}}
if(idx==chnl_num||idx+3>=chnl_num){return false;}
if(baseCH>=165){if(idx+5>=chnl_num){return false;}
if(chnl_list[idx+1]==baseCH+4&&chnl_list[idx+3]==baseCH+8&&chnl_list[idx+5]==baseCH+12){return true;}}
if(chnl_list[idx+1]==baseCH+4&&chnl_list[idx+2]==baseCH+8&&chnl_list[idx+3]==baseCH+12){return true;}else{return false;}}
function is40MChannel(chnl_list,chnl_num,channel){var idx;var chNO;var baseCH=0,MAX_NUM_40M_CH=CH_40m.length;if((CH_40m[MAX_NUM_40M_CH-1]<=channel)&&((CH_40m[MAX_NUM_40M_CH-1]+4)>=channel)){baseCH=CH_40m[MAX_NUM_40M_CH-1];}else{for(chNO=0;chNO<MAX_NUM_40M_CH-1;chNO++){if(CH_40m[chNO]<=channel&&CH_40m[chNO+1]>channel){baseCH=CH_40m[chNO];break;}}}
if(baseCH===0){}
for(idx=0;idx<chnl_num;idx++){if(chnl_list[idx]==baseCH){break;}}
if(idx===chnl_num||idx+1>=chnl_num){return false;}
if(chnl_list[idx+1]==baseCH+4){return true;}else{return false;}}
function validateWall(idx){var res=true;var walled_id='#cbid\\.wireless\\.'+idx+'\\.hs_wall';var walledbtn_id='#cbi-wireless-'+idx+'-wallgardenbtn';if($(walled_id).val()!=''){clear_validate_error(walled_id);$(walled_id).val(convert_list($(walled_id).val()));var tmp_arr=$(walled_id).val().split(' ');if(tmp_arr.length>max_list_walled){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,'The total Walled Garden List is up to '+max_list_walled+'.');set_err_msg($(walledbtn_id),true,'');res=false;}else{var cidrToSubnets=['0.0.0.0','128.0.0.0','192.0.0.0','224.0.0.0','240.0.0.0','248.0.0.0','252.0.0.0','254.0.0.0','255.0.0.0','255.128.0.0','255.192.0.0','255.224.0.0','255.240.0.0','255.248.0.0','255.252.0.0','255.254.0.0','255.255.0.0','255.255.128.0','255.255.192.0','255.255.224.0','255.255.240.0','255.255.248.0','255.255.252.0','255.255.254.0','255.255.255.0','255.255.255.128','255.255.255.192','255.255.255.224','255.255.255.240','255.255.255.248','255.255.255.252','255.255.255.254','255.255.255.255'];for(var i=0;i<tmp_arr.length;i++){if(tmp_arr[i].search('/')!=-1){var ip_netmask=tmp_arr[i].split('/');if(ip_netmask.length>2){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,'Some of walled garden addresses are invalid');set_err_msg($(walledbtn_id),true,'');return false;}
var _ip=ip_netmask[0];var _netmask=cidrToSubnets[ip_netmask[1]];if(!is_ip(_ip)){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,'Not a valid IPv4 address!('+_ip+')');set_err_msg($(walledbtn_id),true,'');return false;}
if(_netmask==undefined||!cbi_validators.netmask(_netmask)){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,'Not a valid netmask!('+ip_netmask[1]+')');set_err_msg($(walledbtn_id),true,'');return false;}
if(is_broadcast(_ip,_netmask)){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,'IP address is a broadcast IP.('+_ip+')');set_err_msg($(walledbtn_id),true,'');return false;}}else{if(!cbi_validators.host(tmp_arr[i])){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,'Some of walled garden addresses are invalid');set_err_msg($(walledbtn_id),true,'');return false;}}}}
if(res){clear_validate_error(walled_id);clear_validate_error(walledbtn_id);$(walled_id).css('border-color','');}}
return res;}
function validate_radius_backup(idx){var res_server=true;var res_port=true;var res_secret=true;var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+idx+'\\.radius_auth_enable2';var auth_server_id='#cbid\\.wireless\\.'+idx+'\\.auth_server2';var auth_port_id='#cbid\\.wireless\\.'+idx+'\\.auth_port2';var auth_secret_id='#cbid\\.wireless\\.'+idx+'\\.auth_secret2';clear_validate_error(auth_server_id);clear_validate_error(auth_port_id);clear_validate_error(auth_secret_id);if($(radius_auth_backup_enable_id).is(':checked')){if(!cbi_validators.host($(auth_server_id).val(),LOOPBACK_IP_OK)){set_err_msg($(auth_server_id),true,'Not a valid IPv4 address!');res_server=false;}
if($(auth_port_id).val()===''||(!is_in_range($(auth_port_id).val(),port_min,port_max))){set_err_msg($(auth_port_id),true,'Not a valid port range! Allowed values are integers between '+port_min+' and '+port_max+', inclusive.');res_port=false;}
var _val=$(auth_secret_id).val();if(_val===''||!(typeof _val==='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(auth_secret_id),true,'This value must be between 1 and 200 characters long.');res_secret=false;}}else{$(auth_server_id).val('');$(auth_port_id).val('');$(auth_secret_id).val('');}
return(res_server&&res_port&&res_secret);}
function validate_list(radio_idx,listname){var id_tmp='cbid.wireless.'+radio_idx+'.'+listname;var get_id=document.getElementById(id_tmp);if(get_id){var current_mac_cnt=0;clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.'+listname);var tmp_walled_str=get_id.value.replace(/\r\n|\r|\n/g,';');tmp_walled_str=tmp_walled_str.replace(/(^\s*)|(\s*$)/g,'');var tmp_arr1=tmp_walled_str.split(';');for(var j=0;j<tmp_arr1.length;j++){if(tmp_arr1[j]==''){continue;}
current_mac_cnt++;var tmp_arr2=tmp_arr1[j].split(' ');if(!is_mac(tmp_arr2[0])){set_err_msg(get_id,true,'Not a valid MAC address!('+tmp_arr2[0]+')');return'err_mac';}}
if(listname=='Pairlist'&&current_mac_cnt>max_Pairlist){set_err_msg(get_id,true,'The total pairs are up to '+max_Pairlist+'.');return'err_cnt';}
if(current_mac_cnt>max_list){set_err_msg(get_id,true,'The total Filtered MACs are up to '+max_list+'.');return'err_cnt';}}}
function validate_form(){var err_mac=false;var err_cnt=false;var err_walled=false;var flag_radius=false;var flag_duplicate_ssid=false;var network_behavior=false;var ssid_arr=new Array();var ssid_duplicate_arr=new Array(max_ssids);var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var op_mode=$(mode_id).val();for(var i=1;i<=total_ssids_added;i++){var radio_idx=radio_iface+'_'+i;if(op_mode.indexOf('ap')>=0){var ssid_id='cbid.wireless.'+radio_idx+'.ssid';var get_ssid_id=document.getElementById(ssid_id);if(get_ssid_id&&get_ssid_id.value!=''){clear_validate_error(get_ssid_id);for(var j=0;j<ssid_arr.length;j++){if(get_ssid_id.value==ssid_arr[j]){ssid_duplicate_arr[j]=true;ssid_duplicate_arr[i-1]=true;flag_duplicate_ssid=true;}}
ssid_arr.push(get_ssid_id.value);}}
var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var encryption_val=$(encryption_id).val();clear_validate_error(auth_server_id);clear_validate_error(auth_port_id);clear_validate_error(auth_secret_id);if($(radius_mac_acl_id).is(':checked')||(encryption_val=='ap-wpa'||encryption_val=='ap-wpa2')){if(!cbi_validators.host($(auth_server_id).val(),LOOPBACK_IP_OK)){set_err_msg($(auth_server_id),true,'Not a valid host or IP address!');flag_radius=true;}
if($(auth_port_id).val()==''||(!is_in_range($(auth_port_id).val(),port_min,port_max))){set_err_msg($(auth_port_id),true,'Not a valid port range! Allowed values are integers between '+port_min+' and '+port_max+', inclusive.');flag_radius=true;}
var _val=$(auth_secret_id).val();if(_val==''||!(typeof _val=='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(auth_secret_id),true,'This value must be between 1 and 200 characters long.');flag_radius=true;}}
var acct_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_server';var acct_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_port';var acct_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret';var acct_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable';var acct_interval_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_interval';clear_validate_error(acct_server_id);clear_validate_error(acct_port_id);clear_validate_error(acct_secret_id);clear_validate_error(acct_interval_id);if($(acct_enable_id).is(':checked')){if(!is_ip($(acct_server_id).val())){set_err_msg($(acct_server_id),true,'Not a valid IPv4 address!');flag_radius=true;}
if($(acct_interval_id).val()===''||(!is_in_range($(acct_interval_id).val(),60,600))){set_err_msg($(acct_interval_id),true,'Allowed values are integers between 60 and 600, inclusive.');flag_radius=true;}
if($(auth_port_id).val()==''||(!is_in_range($(auth_port_id).val(),port_min,port_max))){set_err_msg($(auth_port_id),true,'Not a valid port range! Allowed values are integers between '+port_min+' and '+port_max+', inclusive.');flag_radius=true;}
var _val=$(acct_secret_id).val();if(_val==''||!(typeof _val=='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(acct_secret_id),true,'This value must be between 1 and 200 characters long.');flag_radius=true;}}
var acct_server2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_server2';var acct_port2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_port2';var acct_secret2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret2';var acct_enable2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';clear_validate_error(acct_server2_id);clear_validate_error(acct_port2_id);clear_validate_error(acct_secret2_id);if($(acct_enable2_id).is(':checked')){if(!is_ip($(acct_server2_id).val())){set_err_msg($(acct_server2_id),true,'Not a valid IPv4 address!');flag_radius=true;}
if($(acct_port_id).val()===''||(!is_in_range($(acct_port2_id).val(),port_min,port_max))){set_err_msg($(acct_port2_id),true,'Not a valid port range! Allowed values are integers between '+port_min+' and '+port_max+', inclusive.');flag_radius=true;}
var _val=$(acct_secret2_id).val();if(_val===''||!(typeof _val==='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(acct_secret2_id),true,'This value must be between 1 and 200 characters long.');flag_radius=true;}}
var maclist_result=validate_list(radio_idx,'maclist');var Pairlist_result=validate_list(radio_idx,'Pairlist');if(maclist_result=='err_mac'||Pairlist_result=='err_mac'){err_mac=true;}
if(maclist_result=='err_cnt'||Pairlist_result=='err_cnt'){err_cnt=true;}
if(!validateWall(radio_idx)){err_walled=true;}
if(!validate_radius_backup(radio_idx)){flag_radius=true;}
if(!validate_network_behavior(radio_idx)){network_behavior=true;}}
if(op_mode.indexOf('ap')>=0){if(flag_duplicate_ssid){for(var i=1;i<=max_ssids;i++){if(ssid_duplicate_arr[i-1]){var _tmp='#cbid\\.wireless\\.'+radio_iface+'_'+i+'\\.ssid';set_err_msg(_tmp,true,'Duplicated SSID');}}}}
if(err_mac||err_cnt||err_walled||flag_radius||flag_duplicate_ssid||network_behavior){return false;}
return true;}
function validate_radius_dae(idx){var res_server=true;var res_port=true;var res_secret=true;var dae_enable_id='#cbid\\.wireless\\.'+idx+'\\.dae_enable';var dae_client_id='#cbid\\.wireless\\.'+idx+'\\.dae_client';var dae_port_id='#cbid\\.wireless\\.'+idx+'\\.dae_port';var dae_secret_id='#cbid\\.wireless\\.'+idx+'\\.dae_secret';clear_validate_error(dae_client_id);clear_validate_error(dae_port_id);clear_validate_error(dae_secret_id);if($(dae_enable_id).is(':checked')){if(!is_ip($(dae_client_id).val())){set_err_msg($(dae_client_id),true,'Not a valid IPv4 address!');res_server=false;}
if($(dae_port_id).val()===''||(!is_in_range($(dae_port_id).val(),port_min,port_max))){set_err_msg($(dae_port_id),true,'Not a valid port range! Allowed values are integers between '+port_min+' and '+port_max+', inclusive.');res_port=false;}
var _val=$(dae_secret_id).val();if(_val===''||!(typeof _val==='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(dae_secret_id),true,'This value must be between 1 and 200 characters long.');res_secret=false;}}else{$(dae_client_id).val('');$(dae_port_id).val('');$(dae_secret_id).val('');}
return(res_server&&res_port&&res_secret);}
function convert_list(val){var tmp_walled_str=val.replace(/\r\n|\r|\n/g,' ');tmp_walled_str=tmp_walled_str.replace(/(^\s*)|(\s*$)/g,'');tmp_walled_str=tmp_walled_str.replace(/\s+/g,' ');return tmp_walled_str;}
function radius_dae_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var dae_enable_rowid='#cbi-wireless-'+radio_idx+'-dae_enable';var dae_client_rowid='#cbi-wireless-'+radio_idx+'-dae_client';var dae_port_rowid='#cbi-wireless-'+radio_idx+'-dae_port';var dae_secret_rowid='#cbi-wireless-'+radio_idx+'-dae_secret';if(_enabled){var dae_client_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_client';var dae_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_port';var dae_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_secret';$(dae_client_id).change(function(){validate_radius_dae(radio_idx);});$(dae_port_id).change(function(){validate_radius_dae(radio_idx);});$(dae_secret_id).change(function(){validate_radius_dae(radio_idx);});$(dae_client_rowid).show();$(dae_port_rowid).show();$(dae_secret_rowid).show();}else{var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';$(dae_enable_id).attr('checked',false);$(dae_client_rowid).hide();$(dae_port_rowid).hide();$(dae_secret_rowid).hide();}
validate_radius_dae(radio_idx);}
function radius_mac_acl_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var dynamic_option_id='cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan';var dynamic_option='<option id="cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan" value="dynamic_vlan">Dynamic VLAN</option>';var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var nbh_val=$(network_behavior_id).val();var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var encryption_val=$(encryption_id).val();var dae_enable_id=$('#cbi-wireless-'+radio_idx+'-dae_enable');var radius_auth_backup=$('#cbi-wireless-'+radio_idx+'-radius_auth_enable2');$('#'+dynamic_option_id).remove();if(_enabled||(encryption_val=='ap-wpa'||encryption_val=='ap-wpa2')){$(network_behavior_id).append(dynamic_option);dae_enable_id.show();radius_dae_enable_change(true,ssid_id);radius_auth_backup.show();radius_auth_backup_enable_change(true,ssid_id);$('#cbi-wireless-'+radio_idx+'-auth_server').show();$('#cbi-wireless-'+radio_idx+'-auth_port').show();$('#cbi-wireless-'+radio_idx+'-auth_secret').show();}else{dae_enable_id.hide();radius_dae_enable_change(false,ssid_id);radius_auth_backup.hide();radius_auth_backup_enable_change(false,ssid_id);$('#cbi-wireless-'+radio_idx+'-auth_server').hide();$('#cbi-wireless-'+radio_idx+'-auth_port').hide();$('#cbi-wireless-'+radio_idx+'-auth_secret').hide();}
$(network_behavior_id).val(nbh_val);}
function radius_auth_backup_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var auth_backup_server_rowid='#cbi-wireless-'+radio_idx+'-auth_server2';var auth_backup_port_rowid='#cbi-wireless-'+radio_idx+'-auth_port2';var auth_backup_secret_rowid='#cbi-wireless-'+radio_idx+'-auth_secret2';if(_enabled){var auth_backup_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server2';var auth_backup_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port2';var auth_backup_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret2';$(auth_backup_server_id).change(function(){validate_radius_backup(radio_idx);});$(auth_backup_port_id).change(function(){validate_radius_backup(radio_idx);});$(auth_backup_secret_id).change(function(){validate_radius_backup(radio_idx);});$(auth_backup_server_rowid).show();$(auth_backup_port_rowid).show();$(auth_backup_secret_rowid).show();}else{var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_auth_enable2';$(radius_auth_backup_enable_id).attr('checked',false);$(auth_backup_server_rowid).hide();$(auth_backup_port_rowid).hide();$(auth_backup_secret_rowid).hide();}
validate_radius_backup(radio_idx);}
function radius_acct_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var radius_acct_backup=$('#cbi-wireless-'+radio_idx+'-acct_enable2');if(_enabled){$('#cbi-wireless-'+radio_idx+'-acct_server').show();$('#cbi-wireless-'+radio_idx+'-acct_port').show();$('#cbi-wireless-'+radio_idx+'-acct_secret').show();$('#cbi-wireless-'+radio_idx+'-acct_interval').show();radius_acct_backup.show();radius_acct_backup_enable_change(true,ssid_id);}else{$('#cbi-wireless-'+radio_idx+'-acct_server').hide();$('#cbi-wireless-'+radio_idx+'-acct_port').hide();$('#cbi-wireless-'+radio_idx+'-acct_secret').hide();$('#cbi-wireless-'+radio_idx+'-acct_interval').hide();radius_acct_backup.hide();radius_acct_backup_enable_change(false,ssid_id);}}
function radius_acct_backup_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var auth_acct_backup_server_rowid='#cbi-wireless-'+radio_idx+'-acct_server2';var auth_acct_backup_port_rowid='#cbi-wireless-'+radio_idx+'-acct_port2';var auth_acct_backup_secret_rowid='#cbi-wireless-'+radio_idx+'-acct_secret2';if(_enabled){var auth_acct_backup_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_server2';var auth_acct_backup_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_port2';var auth_acct_backup_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret2';$(auth_acct_backup_server_rowid).show();$(auth_acct_backup_port_rowid).show();$(auth_acct_backup_secret_rowid).show();}else{var radius_auth_acct_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';$(radius_auth_acct_backup_enable_id).attr('checked',false);$(auth_acct_backup_server_rowid).hide();$(auth_acct_backup_port_rowid).hide();$(auth_acct_backup_secret_rowid).hide();}}
function radius_change(flag,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var radius_mac_acl_row_id='#cbi-wireless-'+radio_idx+'-radius_mac_acl';var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';var dae_enable_rowid='#cbi-wireless-'+radio_idx+'-dae_enable';var radius_field_optional=function(){return!$(radius_mac_acl_id).is(':checked');};if(flag=='show'){$(radius_mac_acl_row_id).show();}else{$(radius_mac_acl_row_id).hide();$(radius_mac_acl_id).attr('checked',false);clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_server');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_port');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_server2');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_port2');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret2');}
radius_mac_acl_change($(radius_mac_acl_id).is(':checked'),ssid_id);}
function change_hwmode(){var hwmode=document.getElementById('cbid.wireless.'+radio_iface+'.hwmode');var ht_mode=document.getElementById('cbid.wireless.'+radio_iface+'.htmode');var mode_val=$(hwmode).val();var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var op_mode=$(mode_id).val();for(i=1;i<max_ssids+1;i++){var radio_idx=radio_iface+'_'+i;var wmm_id=document.getElementById('cbid.wireless.'+radio_idx+'.wmm_enable');var ht_mode_val=$(ht_mode).val();if(mode_val=='11a'||mode_val=='11g'){if(!mgmt_enabled){$(wmm_id).removeAttr('disabled');}}else{$(wmm_id).attr('disabled','disabled');$(wmm_id).attr('checked','checked');}
if(op_mode!='sta-wds'){var wep_option_id='cbi-wireless-'+radio_idx+'-encryption-wep-open';var wep_option='<option id="cbi-wireless-'+radio_idx+'-encryption-wep-open" value="wep-open">WEP Open System</option>';var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var current_encryption=$(encryption_id).val();var wep_key_id='cbi-wireless-'+radio_idx+'-key1';$('#'+wep_option_id).remove();if(mode_val!='11na'&&mode_val!='11ng'&&mode_val!='11ac'){$(encryption_id).append(wep_option);}else{$('#'+wep_key_id).remove();}
sort_encrytion_option(encryption_id);$(encryption_id).val(current_encryption);}
$(ht_mode).val(ht_mode_val);}
var band=mode_val;var txrate=current_datarate;var rate_id=document.getElementById('cbid.wireless.'+radio_iface+'.data_rate');show_datarate(band,txrate,rate_id);if(current_band=='5'){var old_mode=$(ht_mode).val();var prev_data=$(ht_mode).data('previous');$(ht_mode).empty();$(ht_mode).append('<option value=\'20\'>20MHz</option>');if(mode_val!='11a'){$(ht_mode).append('<option value=\'40\'>40MHz</option>');}
if(mode_val=='11ac'){$(ht_mode).append('<option value=\'80\'>80MHz</option>');}else{if(old_mode=='80'){$(ht_mode).val('20');}}
if(!prev_data||!$(ht_mode).find('option[value=\''+old_mode+'\']')[0]){old_mode='20';}
$(ht_mode).val(old_mode);$(ht_mode).data('previous',old_mode);}}
var loaded=0;var cnt=0;function load_ssid(ssid_id,i){(function(ssid_id,i){var radio_idx=radio_iface+'_'+ssid_id;$.get(ssid_url+'/'+ssid_id,null,function(data){loaded++;if(loaded==total_ssids_added){$('btn_remove_ssid').removeAttr('disabled');}
$('#spinner'+i).removeClass('icon-spin');$('.spinner-container'+i).hide();$('#SSID'+i).append(data);$('#SSID_tab_'+i).click(function(){var tmp_arr=(this.id).split('_');site_entity_control(tmp_arr[2]);});cbi_d_update('cbid.wireless.'+radio_idx+'.disabled');var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';encry_change(ssid_id);$(encryption_id).change(function(){encry_change(ssid_id);});var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';$(radius_mac_acl_id).change(function(){radius_mac_acl_change($(radius_mac_acl_id).is(':checked'),ssid_id);});var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_auth_enable2';$(radius_auth_backup_enable_id).change(function(){radius_auth_backup_enable_change($(radius_auth_backup_enable_id).is(':checked'),ssid_id);});var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';$(dae_enable_id).change(function(){radius_dae_enable_change($(dae_enable_id).is(':checked'),ssid_id);});var radius_acct_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable';$(radius_acct_enable_id).change(function(){radius_acct_enable_change($(radius_acct_enable_id).is(':checked'),ssid_id);});var radius_acct_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';$(radius_acct_backup_enable_id).change(function(){radius_acct_backup_enable_change($(radius_acct_backup_enable_id).is(':checked'),ssid_id);});var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';$(auth_server_id).change(function(){clear_validate_error(auth_server_id);});$(auth_port_id).change(function(){clear_validate_error(auth_port_id);});$(auth_secret_id).change(function(){clear_validate_error(auth_secret_id);});var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';network_behavior_change(radio_idx);$(network_behavior_id).change(function(){network_behavior_change(radio_idx);});var limit_up_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';limit_enable_change(ssid_id);$(limit_up_enable_id).change(function(){limit_enable_change(ssid_id);});var limit_down_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';limit_enable_change(ssid_id);$(limit_down_enable_id).change(function(){limit_enable_change(ssid_id);});var walled_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs_wall';$(walled_id).change(function(){validateWall(radio_id+'_'+ssid_id);});if(loaded==total_ssids_enabled){set_btn_state();change_opmode();change_hwmode();}
var $ssid_title=$('#cbid\\.wireless\\.'+radio_idx+'\\.ssid');var $ssid_tab=$('[href="#SSID'+ssid_id+'"]');var ssid_tab_html='<span>'+$ssid_title.val()+'</span>&nbsp;(SSID'+ssid_id+')';$ssid_tab.html(ssid_tab_html);}).done(function(data){cnt++;if(cnt<=created_ssid_ids.length){load_ssid(created_ssid_ids[cnt-1],cnt);}});})(ssid_id,cnt);}
function sort_encrytion_option(_encryption_id){var tmp_options=$(_encryption_id+' option');var arr=tmp_options.map(function(_,o){return{t:$(o).text(),v:o.value,_id:o.id};}).get();arr.sort(function(o1,o2){return o1.t>o2.t?1:o1.t<o2.t?-1:0;});tmp_options.each(function(i,o){o.value=arr[i].v;$(o).text(arr[i].t);o.id=arr[i]._id;});}
$(function(){$('body').tooltip({selector:'[data-rel=tooltip]'});channel_id='cbid\\.wireless\\.'+radio_iface+'\\.channel';$('#select_all').change(function(){var tbl_name='#table_channel';$(tbl_name+' tbody:checkbox').prop('checked',$(this).is(':checked'));var checkboxes=$(this).closest('table').find('.region_ct');checkboxes.prop('checked',$(this).is(':checked'));});$(document).on('click','.region_ct',function(){var checkedLength=$('.region_ct:checked').length;var checkboxLength=$('.region_ct').length;$('#select_all').prop('checked',checkedLength==checkboxLength);});$('#btn_wifi_frequency').click(function(){save_channel();});$('#close_frequency_window').click(function(){save_channel();});wifi_channel();var default_specific_channel_id='cbi-wireless-'+radio_iface+'-channel-unknown';var new_channel_specific_option='cbi-wireless-'+radio_iface+'-channel-'+channel_val;var channel_specific_option='';if(channel_val=='auto'){channel_specific_option='<option id="'+default_specific_channel_id+'" value="unknown">Specific Frequency</option>';$('#frequency_btn_'+radio_iface).val('Auto');}else{channel_specific_option='<option id="'+new_channel_specific_option+'" value="'+channel_val+'">Specific Frequency</option>';if(channel_val.search('-')>=0){$('#frequency_btn_'+radio_iface).val('Auto');}else{var selected_freq_full=$('#cbi-wifi_channel-'+channel_val+'-frequency').text();var selected_freq_full_arr=selected_freq_full.split(' ');$('#frequency_btn_'+radio_iface).val(channel_val+' ('+(selected_freq_full_arr[0]/1000)+' GHz)');}}
var channel_auto_option='<option id="cbi-wireless-'+radio_iface+'-channel-auto" value="auto">Auto</option>';$('#'+channel_id).empty();$('#'+channel_id).append(channel_auto_option);$('#'+channel_id).append(channel_specific_option);if(channel_val!='auto'){$('#'+new_channel_specific_option).prop('selected','selected');}
$('#cbi').submit(function(){if(!validate_form()){$('#form_error_msg').text('Some fields are invalid, please see messages below!');$('#form_error_msg_placeholder').removeClass('hide');window.document.body.scrollTop=0;window.document.documentElement.scrollTop=0;return false;}else{if(cbi_validate_form(document.getElementById('cbi'),'Some fields are invalid, please see messages below!')){for(var i=1;i<=total_ssids_added;i++){disabled_items(radio_id,i,'sta_mode');}}
$('#'+channel_id).prop('disabled',false);$('#tx_slider').slider('enable');$('#cbid\\.wireless\\.'+radio_iface+'\\.txpower').removeAttr('disabled');return true;}});generate_wme_table();$('#btn_wifi_wme_save').click(function(){save_wme_table();});$('#close_wme_window').click(function(){save_wme_table();});$('#cbi-wireless-'+radio_iface+'-tx_streams').addClass('hidden');$('#cbi-wireless-'+radio_iface+'-rx_streams').addClass('hidden');$('#cbid\\.wireless\\.'+radio_iface+'\\.ack').on('change input',function(){set_ack_distance();});$('#'+channel_id).change(set_txpower_list);if(!bandsteering_allowed){$('#cbid\\.wireless\\.'+radio_iface+'\\.bandsteering').attr('disabled','disabled');}
set_txpower_list();set_ack_distance();$('#btn_add_ssid').attr('disabled','disabled');$('#btn_save').attr('disabled','disabled');$('#btn_add_ssid').click(function(){add_ssid();});$('#btn_wifi_scan').click(function(){scan();});$('#btn_wifi_aiming_stop').attr('disabled','disabled');$('#btn_wifi_aiming_start').click(function(){aiming_stop_Tid=-1;aiming_timeout_id=setTimeout(send_aiming_request,1*1000);$('#btn_wifi_aiming_start').attr('disabled','disabled');$('#aiming_mode').attr('disabled','disabled');$('#btn_wifi_aiming_stop').removeAttr('disabled');});$('#btn_wifi_aiming_stop').click(function(){$('#spinner_aiming_container').hide();clearTimeout(aiming_timeout_id);aiming_stop_Tid=aiming_timeout_id;$('#btn_wifi_aiming_start').removeAttr('disabled');$('#aiming_mode').removeAttr('disabled');$('#btn_wifi_aiming_stop').attr('disabled','disabled');});$('#close_aiming_window').click(function(){$('#spinner_aiming_container').hide();clearTimeout(aiming_timeout_id);aiming_stop_Tid=aiming_timeout_id;$('#btn_wifi_aiming_start').removeAttr('disabled');$('#aiming_mode').removeAttr('disabled');$('#btn_wifi_aiming_stop').attr('disabled','disabled');});$('#btn_remove_ssid').click(function(){remove_ssid();});$('#btn_remove_ssid').attr('disabled','disabled');total_ssids_added=total_ssids_enabled;if(created_ssid_ids.length==0||created_ssid_ids.length==undefined){$('#ssidTabContent').html('No VAP is created.');set_btn_state();}else{$('#ssidTabContent').html();}
cnt=1;load_ssid(created_ssid_ids[cnt-1],cnt);var status_id=document.getElementById('cbid.wireless.'+radio_iface+'.disabled');$(status_id).click(function(){if($(status_id).is(':checked')){$('#'+radio_iface+'_1_wan_change_notify').addClass('hidden');$('#'+radio_iface+'_1_reset_inet_src').val('0');var op_mode=$('#cbid\\.wireless\\.'+radio_iface+'\\.mode').val();if(op_mode.indexOf('sta')<0){$('#'+radio_iface+'_1_set_inet_src').val('0');}else{$('#'+radio_iface+'_1_set_inet_src').val('1');}
$('#'+radio_iface+'_1_wan_notify').removeClass('hidden');}else{$('#'+radio_iface+'_1_wan_change_notify').removeClass('hidden');$('#'+radio_iface+'_1_reset_inet_src').val('1');$('#'+radio_iface+'_1_set_inet_src').val('1');$('#'+radio_iface+'_1_wan_notify').addClass('hidden');}});var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var hwmode=document.getElementById('cbid.wireless.'+radio_iface+'.hwmode');$(document.getElementById('cbid.wireless.'+radio_iface+'.htmode')).data('previous','valid');$(mode_id).change(function(){if($(mode_id).val().indexOf('sta')<0){$('#ssid_tabs li').removeClass('active');$('#ssidTabContent .tab-pane').removeClass('active');$('#SSID_tab_1').addClass('active');$('#SSID1').addClass('active');}
change_opmode();change_hwmode();});$(hwmode).change(change_hwmode);var tx=document.getElementById('cbid.wireless.'+radio_iface+'.tx_streams');var rx=document.getElementById('cbid.wireless.'+radio_iface+'.rx_streams');var select_tx=$(tx);var select_rx=$(rx);$(tx).change(function(){set_txpower_list();if(select_tx[0].selectedIndex==1){$(rx).children('option[value="1"]').hide();select_rx[0].selectedIndex=1;}else{$(rx).children('option[value="1"]').show();}});$(tx).change();var id=document.getElementById('cbid.wireless.'+radio_iface+'.ack');var max_tmp=255;var min_tmp=32;$('#ack_slider').slider({orientation:'horizontal',range:'min',max:max_tmp,min:min_tmp,value:$(id).val(),slide:function(event,ui){$(id).val(ui.value);clear_validate_error('#cbid\\.wireless\\.'+radio_iface+'\\.ack');set_ack_distance();}});$(id).change(function(){if($(id).val().match(/^-?[0-9]+$/)){$('#ack_slider').slider('value',$(id).val());}});var tx_name='cbid.wireless.'+radio_iface+'.txpower';var tx=document.getElementById(tx_name);var select=$(tx);var tx_streams=$('#cbid\\.wireless\\.'+radio_iface+'\\.tx_streams').val();var tx_offset=Math.floor(10*Math.log(tx_streams)/Math.LN10+0.5);var tx_max=$(tx).find('option').length-1+tx_offset;var tx_min=tx_offset;var current_chan=$('#'+channel_id).val();if(is_OAP&&country_code=='TH'&&(current_chan>=36&&current_chan<=48)){tx_max=$(tx).find('option').length-1+2+tx_offset;tx_min=0;$('#tx_slider').slider({disabled:true});}
$('#tx_slider').slider({orientation:'horizontal',range:'min',min:tx_min,max:tx_max,value:select.val(),slide:function(event,ui){$('#cbid\\.wireless\\.'+radio_iface+'\\.txpower option[value=\''+ui.value+'\']').prop('selected',true);}});tx_slider_initialized=true;$(tx).change(function(){$('#tx_slider').slider('value',select.val());});$('#wmm_save').click(function(){if(($('#ac_bk_cwmin').val()<1)||($('#ac_bk_cwmin').val()>10)){return false;}
if(($('#ac_bk_cwmax').val()<1)||($('#ac_bk_cwmax').val()>10)){return false;}
if(($('#ac_bk_aifsn').val()<1)||($('#ac_bk_aifsn').val()>7)){return false;}
if(($('#ac_bk_txop').val()<0)||($('#ac_bk_txop').val()>256)){return false;}
if(($('#ac_be_cwmin').val()<1)||($('#ac_be_cwmin').val()>10)){return false;}
if(($('#ac_be_cwmax').val()<1)||($('#ac_be_cwmax').val()>10)){return false;}
if(($('#ac_be_aifsn').val()<1)||($('#ac_be_aifsn').val()>7)){return false;}
if(($('#ac_be_txop').val()<0)||($('#ac_be_txop').val()>256)){return false;}
if(($('#ac_vi_cwmin').val()<1)||($('#ac_vi_cwmin').val()>10)){return false;}
if(($('#ac_vi_cwmax').val()<1)||($('#ac_vi_cwmax').val()>10)){return false;}
if(($('#ac_vi_aifsn').val()<1)||($('#ac_vi_aifsn').val()>7)){return false;}
if(($('#ac_vi_txop').val()<0)||($('#ac_vi_txop').val()>256)){return false;}
if(($('#ac_vo_cwmin').val()<1)||($('#ac_vo_cwmin').val()>10)){return false;}
if(($('#ac_vo_cwmax').val()<1)||($('#ac_vo_cwmax').val()>10)){return false;}
if(($('#ac_vo_aifsn').val()<1)||($('#ac_vo_aifsn').val()>7)){return false;}
if(($('#ac_vo_txop').val()<0)||($('#ac_vo_txop').val()>256)){return false;}
$('#wmm_data').submit();$('#wmm_set').modal('hide');});function ht_ch_ctrl(){var op_mode=$('#cbid\\.wireless\\.'+radio_iface+'\\.mode').val();if(op_mode.indexOf('sta')>=0){return;}
var ht_mode_val=$(ht_mode).val();if(current_band=='2.4'){if(ht_mode_val==='40'){$('#cbi-wireless-'+radio_iface+'-disablecoext').show();}else{$('#cbi-wireless-'+radio_iface+'-disablecoext').hide();}}}
var ht_mode=document.getElementById('cbid.wireless.'+radio_iface+'.htmode');$(ht_mode).change(ht_ch_ctrl);$(ht_mode).change();$('#table_channel').tablesorter({sortList:[[1,0]],headers:{0:{sorter:false},3:{sorter:false},4:{sorter:false}}});});function show_datarate(band,txrate,rate_id){$(rate_id).empty();$(rate_id).append('<option value="auto">Auto</option>');if(band==='11b'||band==='11g'||band==='11ng'){$(rate_id).append('<option value="0">1M</option>');$(rate_id).append('<option value="1">2M</option>');$(rate_id).append('<option value="2">5.5M</option>');$(rate_id).append('<option value="3">11M</option>');}
if(band==='11ng'||band==='11g'||band==='11na'||band==='11a'||band==='11ac'){$(rate_id).append('<option value="4">6M</option>');$(rate_id).append('<option value="5">9M</option>');$(rate_id).append('<option value="6">12M</option>');$(rate_id).append('<option value="7">18M</option>');$(rate_id).append('<option value="8">24M</option>');$(rate_id).append('<option value="9">36M</option>');$(rate_id).append('<option value="10">48M</option>');$(rate_id).append('<option value="11">54M</option>');}
if(band==='11ng'||band==='11na'||band==='11ac'){$(rate_id).append('<option value="12">MCS0</option>');$(rate_id).append('<option value="13">MCS1</option>');$(rate_id).append('<option value="14">MCS2</option>');$(rate_id).append('<option value="15">MCS3</option>');$(rate_id).append('<option value="16">MCS4</option>');$(rate_id).append('<option value="17">MCS5</option>');$(rate_id).append('<option value="18">MCS6</option>');$(rate_id).append('<option value="19">MCS7</option>');if(max_tx_streams>1){$(rate_id).append('<option value="20">MCS8</option>');$(rate_id).append('<option value="21">MCS9</option>');$(rate_id).append('<option value="22">MCS10</option>');$(rate_id).append('<option value="23">MCS11</option>');$(rate_id).append('<option value="24">MCS12</option>');$(rate_id).append('<option value="25">MCS13</option>');$(rate_id).append('<option value="26">MCS14</option>');$(rate_id).append('<option value="27">MCS15</option>');}
if(max_tx_streams>2){$(rate_id).append('<option value="100">MCS16</option>');$(rate_id).append('<option value="101">MCS17</option>');$(rate_id).append('<option value="102">MCS18</option>');$(rate_id).append('<option value="103">MCS19</option>');$(rate_id).append('<option value="104">MCS20</option>');$(rate_id).append('<option value="105">MCS21</option>');$(rate_id).append('<option value="106">MCS22</option>');$(rate_id).append('<option value="107">MCS23</option>');}}
$(rate_id).val(txrate);}