
var discovery_row='<tr class="cbi-section-table-row" id="cbi-device_discovery-CFG_ID" data-lan>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-device_model">'
+'</div>'
+'</td>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-hostname">'
+'</div>'
+'</td>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-mac_address">'
+'</div>'
+'</td>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-device_ip">'
+'</div>'
+'</td>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-ssids">'
+'</div>'
+'</td>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-vlan_id">'
+'</div>'
+'</td>'
+' '
+'<td class="cbi-value-field">'
+'<div id="cbi-device_discovery-CFG_ID-setting">'
+'<input id="cbi-device_discovery-CFG_ID-edit" value="1" type="checkbox">'
+'<label class="lbl"></label>'
+'</div>'
+'</td>'
+'';function device_discovery(action_flag){var tbl_name='#table_discovery';$(tbl_name+' tbody').html('');if(action_flag=='start'){$('#row_empty').hide();$('#spinner_scan').addClass('icon-spin');$('#spinner_scan_container').show();$('#btn_scan').attr('disabled',true);$('#btn_clear').attr('disabled',true);var cnt=0;$.get(discovery_start_url,null,function(data){$('#spinner_scan').removeClass('icon-spin');$('#spinner_scan_container').hide();if(data['dev']){var list_arr=data['dev'];for(var list in list_arr){if(list_arr.hasOwnProperty(list)){var _list=list_arr[list];var row=discovery_row.replace(/CFG_ID/g,cnt);row=$.parseHTML(row);if($(tbl_name+' tr').length>1){var selector=tbl_name+' tr:last';$(selector).after(row);}else{$(tbl_name+' tbody').append(row);}
$('#cbi-device_discovery-'+cnt+'-device_model').text(_list.model);$('#cbi-device_discovery-'+cnt+'-hostname').text(_list.hostname);$('#cbi-device_discovery-'+cnt+'-mac_address').text(_list.mac);$('#cbi-device_discovery-'+cnt+'-device_ip').text(_list.wan_ip);$('#cbi-device_discovery-'+cnt+'-ssids').text(_list.ssids.length==undefined?'-':_list.ssids);$('#cbi-device_discovery-'+cnt+'-vlan_id').text(_list.vlanids.length==undefined?'-':_list.vlanids);$('#cbi-device_discovery-'+cnt+'-setting').text(_list.setting);cnt++;}}}else{$('#row_empty').show();}
$('#btn_scan').attr('disabled',false);$('#btn_clear').attr('disabled',false);$(tbl_name).trigger('update');});}else{$.get(discovery_stop_url,null,function(data){});$('#row_empty').show();}}
$(function(){device_discovery('start');});