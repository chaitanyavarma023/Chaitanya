
var MAX_CUSTOM_LANS=5;function enable_dhcp(network){var lan_enabled=$('#cbid\\.network\\.'+network+'\\.auto').is(':checked');var enabled=$('#cbid\\.network\\.'+network+'\\.dhcp').is(':checked');$('.dhcp_'+network).prop('readOnly',!enabled||!lan_enabled);$('.dhcp_'+network+'_lease').prop('disabled',!enabled||!lan_enabled);if(!enabled||!lan_enabled){clear_validate_error('.dhcp_'+network);}}
function enable_lan(network){var id='cbid\\.network\\.'+network+'\\.auto';var enabled=$('#'+id).is(':checked');var selector='#cbi-network-'+network+' input';var selector2='#cbi-network-'+network+' select';$(selector).prop('readOnly',!enabled);$(selector2).prop('readOnly',!enabled);if(!enabled){clear_validate_error(selector);clear_validate_error(selector2);$('#'+network+'_title h4').css('font-style','italic');$('#'+network+'_title h4').addClass('grey');}else{$('#'+network+'_title h4').css('font-style','normal');$('#'+network+'_title h4').removeClass('grey');}}
function delete_lan(e){$('#alert_up_max').hide();$('#add_lan_btn').attr('disabled',false);e.preventDefault();var network=$(this).data('lan');$('#'+network+'_title').remove();$('#cbi-network-'+network).slideUp('normal',function(){$(this).remove();});var row_id='acn-dialog-network-'+network;$('#'+row_id+' input').each(function(){if(this.id.indexOf('acn.del.network')>=0){$(this).attr('value',1);}});validate_form();}
function next_lan_id(){var next_id=0;for(var i=0;i<MAX_CUSTOM_LANS;i++){if($('#cbid\\.network\\.custom_'+i+'\\.ipaddr').length){continue;}
next_id=i;break;}
return next_id;}
function isExceedMaxNum(){var cnt=0;for(var i=0;i<MAX_CUSTOM_LANS;i++){if($('#cbid\\.network\\.custom_'+i+'\\.ipaddr').length){cnt++;}}
return(cnt>=MAX_CUSTOM_LANS);}
function add_lan(){var contents=$('#lan_template').html();$('#alert_up_max').hide();$('#add_lan_btn').attr('disabled',false);var new_lan_name='custom_'+next_lan_id();contents=contents.replace(/%CUSTOM%/g,new_lan_name);var new_ids=$('#network\\.new_ids').val();$('#network\\.new_ids').val(new_ids+';'+new_lan_name);$('#lan_list').append(contents);add_validation_handlers.call($('#cbi-network-'+new_lan_name)[0]);add_button_handlers('#'+new_lan_name+'_title','#cbi-network-'+new_lan_name);if(isExceedMaxNum()){$('#alert_up_max').show();$('#add_lan_btn').attr('disabled',true);$('#maxLansNum').html(MAX_CUSTOM_LANS);}}
function validate_form(){var res_ip=validate_ip_addrs();var res_dhcp=validate_dhcp_fields();var res_title=validateCustomName();var res_ip_aliases=validateIpAliases();var res=(res_ip&&res_dhcp&&res_title&&res_ip_aliases);if(!res){cbi_show_form_error();var position=$('#add_lan_btn').position();window.scrollTo(0,position.top);}
return res;}
$(function(){$('#cbi').submit(function(){return validate_form();});if(isExceedMaxNum()){$('#alert_up_max').show();$('#add_lan_btn').attr('disabled',true);$('#maxLansNum').html(MAX_CUSTOM_LANS);}
$('#add_lan_btn').click(add_lan);add_button_handlers();$('.lan_section').each(add_validation_handlers);$('button.ace-tooltip').tooltip();$('button.disabled').click(function(){if(!$(this).hasClass('disabled')){$('.disabled').removeClass('disabled').attr('rel',null);$(this).addClass('disabled').attr('rel','tooltip');}});$('.cbi-section-table-row').each(function(){add_validation_ipaliases_handlers(this.id);});});function add_button_handlers(header_prefix,widget_prefix){if(header_prefix==null){header_prefix='';}
if(widget_prefix==null){widget_prefix='';}
$(header_prefix+' .btn-delete-lan').click(delete_lan);}