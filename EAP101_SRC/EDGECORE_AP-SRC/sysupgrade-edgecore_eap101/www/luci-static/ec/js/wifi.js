
var total_ssids_added=0;var total_ssids_enbaled_cnt=0;var security_method;var tx_slider_initialized=false;var max_list=512;var max_Pairlist=5;var channel_id='';var beacon_id='';var mesh_id='#cbid\\.wireless\\.wmesh\\.mesh_id';var mesh_key='#cbid\\.wireless\\.wmesh\\._wpa_key';var mesh_enable='#cbid\\.wireless\\.wmesh\\.disabled';var max_list_walled=32;var max_multikey=128;var max_multikeylist=128;function popupWindow(url){var win=window.open(url,'popupWindow','toolbar=no,location=no,directories=no,status=no,bar=no,scrollbars=no,resizable=yes,copyhistory=no,width=850,height=590,screenX=100,screenY=0,top=0,left=100');win.focus();}
function access_permission(){if(root_user=='false'&&msp_disabled=='false'){$('#cbi-wireless-'+radio_iface+'-disabled').hide();$('#cbi-wireless-'+radio_iface+'-mode').hide();$('#cbi-wireless-'+radio_iface+'-hwmode').hide();$('#cbi-wireless-'+radio_iface+'-htmode').hide();$('#cbi-wireless-'+radio_iface+'-channel').hide();$('#cbi-wireless-'+radio_iface+'-_channel').hide();$('#cbi-wireless-'+radio_iface+'-beacon_int').hide();$('#cbi-wireless-'+radio_iface+'-_wme').hide();$('#cbi-wireless-'+radio_iface+'-he_bss_color').hide();$('#cbi-wireless-'+radio_iface+'-chan_util_delta').hide();$('#cbi-wireless-'+radio_iface+'-_ofdma').hide();$('#cbi-wireless-'+radio_iface+'-he_twt_required').hide();$('#cbi-wireless-'+radio_iface+'-bandsteering').hide();$('#cbi-wireless-'+radio_iface+'-atfpolicy').hide();$('#cbi-wireless-'+radio_iface+'multicast_to_unicast').hide();$('#cbi-wireless-'+radio_iface+'wmm').hide();$('#cbi-advance-wmesh').hide();$('#cbi-wireless-'+radio_iface+'-txpower').hide();}}
function set_ssid_defaults(id){var radio_idx=radio_iface+'_'+id;$('#cbid\\.wireless\\.'+radio_idx+'\\.disabled').val('0');$('#cbid\\.wireless\\.'+radio_idx+'\\.disabled').attr('checked','checked');$('#cbid\\.wireless\\.'+radio_idx+'\\.ssid').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\._wpa_key').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.encryption').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior option').removeAttr('selected');$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior').val('route');$('#cbid\\.wireless\\.'+radio_idx+'\\.signal_stay').val('-100');$('#cbid\\.wireless\\.'+radio_idx+'\\.hs20_operating_class').val('');$('#cbid\\.wireless\\.'+radio_idx+'\\.signal_connect').val('0');}
function scan(){var radio_idx=radio_iface+'_1';$('#spinner_scan').addClass('icon-spin');$('#spinner_scan_container').show();var showJoin='';$('#scan_results').html('');if($('#cbid\\.wireless\\.'+radio_iface+'\\.mode').val().indexOf('sta')>=0){showJoin='show_join';}
$.get(scan_url+'/'+showJoin,null,function(data){if(data.search('<form method="post" name="login"')!=-1){top.location.href=ssid_url;return;}
$('#scan_results').html(data);$('#spinner_scan').removeClass('icon-spin');$('#spinner_scan_container').hide();$('.join-btn').click(function(){$('#wifi_scan_modal').modal('hide');var security=$(this).attr('data-security');var suites=$(this).attr('data-suites');if(suites==undefined){suites='';}
if(security==undefined){security='';}
suites=suites.toLowerCase();security=security.toLowerCase();$('#cbid\\.wireless\\.'+radio_idx+'\\.ssid').val($(this).attr('data-ssid'));$('#cbid\\.wireless\\.'+radio_idx+'\\.encryption option').removeAttr('selected');if(suites.indexOf('802.1x')>=0){if(security=='wpa 802.1x (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa').prop('selected','selected');}else if(security=='mixed wpa2/wpa3 802.1x (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa3-mixed').prop('selected','selected');}else if(security=='wpa2/wpa3 802.1x (ccmp)'||security=='wpa3 802.1x (none)'){$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2').prop('selected','selected');}}else if(suites.indexOf('psk')>=0){if(security=='wpa psk (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-psk').prop('selected','selected');}else if(security=='wpa2 psk (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-psk2').prop('selected','selected');}else if(security=='mixed wpa2/wpa3 psk/sae (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-sae-mixed').prop('selected','selected');}}else{if(security=='open'||security=='wpa3 owe (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-none').prop('selected','selected');}else if(security=='wpa3 sae (ccmp)'){$('#cbi-wireless-'+radio_idx+'-encryption-sae').prop('selected','selected');}}
$('#cbid\\.wireless\\.'+radio_idx+'\\.cipher option').removeAttr('seleted');if(suites.indexOf('802.x')<0&&suites.indexOf('ccmp')){$('#cbi-wireless-'+radio_idx+'-cipher-ccmp').prop('selected','selected');}
cbi_d_update('cbid.wireless.'+radio_iface+'_1.encryption');cbi_d_update('cbid.wireless.'+radio_iface+'_1.cipher');});});}
var aiming_timeout_id='';var ori_aiming_mode='';var aiming_stop_Tid=-1;function send_aiming_request(){var mode_select=$('#aiming_mode').val();if(ori_aiming_mode!=mode_select){$('#aiming_scan_results').html('');$('#spinner_aiming_container').show();}else{$('#spinner_aiming_container').hide();}
var api=(mode_select=='0')?aiming_tx_api_url:aiming_rx_api_url;$.getJSON(api,{},function(data){$('#spinner_aiming_container').hide();if(aiming_stop_Tid>=0&&aiming_timeout_id>=aiming_stop_Tid){return;}
if(data==''){$('#aiming_scan_results').html(_('No Data'));}else{$('#aiming_scan_results').html(data+' dBm');}
ori_aiming_mode=mode_select;aiming_timeout_id=setTimeout(send_aiming_request,1*1000);});}
function add_ssid(){if($('#btn_add_ssid').attr('disabled')=='disabled'){return;}
$('#btn_add_ssid').attr('disabled','disabled');$('#btn_save').attr('disabled','disabled');$('#btn_apply').attr('disabled','disabled');$(mesh_enable).attr('disabled','disabled');var next_id=total_ssids_added+1;var next_section_id;for(i=1;i<=max_ssids;i++){var id_to_check='#cbid\\.wireless\\.'+radio_iface+'_'+i+'\\.disabled';if($(id_to_check).length==0){next_section_id=i;break;}}
$('#ssid_tabs li').removeClass('active');$('#ssidTabContent .tab-pane').removeClass('active');var ssid_tab_container='<li id=\'SSID_tab_'+next_id
+'\' class=\'active\' data-ssidid=\''+next_id+'\'>'
+'<a data-toggle=\'tab\' href=\'#SSID'+next_id
+'\' style=\'line-height: unset;margin-top: unset;border-top-width:1px;\'><span>SSID'+next_id+'</span></a></li>';$('#last_ssid').before(ssid_tab_container);var ssid_content_container='<div id="SSID'+next_id+'" class="tab-pane active">'
+'<div class="spinner-container'+next_id+'">'
+' <i class="icon-spinner icon-spin" id="spinner'+next_id+'"></i> &nbsp;&nbsp;Loading... '
+'</div>';'</div>';if(next_id==1){$('#ssidTabContent').html('');}
$('#ssidTabContent').append(ssid_content_container);active_id=next_id;var radio_idx=radio_iface+'_'+next_section_id;$.get(ssid_url+'/'+next_section_id,null,function(data){if(data.search('<form method="post" name="login"')!=-1){top.location.href=ssid_url;return;}
$('#SSID'+next_id).append(data);$('#spinner'+next_id).removeClass('icon-spin');$('.spinner-container'+next_id).hide();$('#SSID_tab_'+next_id).click(function(){var tmp_arr=(this.id).split('_');if(tmp_arr[2]=='1'){$('#btn_remove_ssid').hide();}else{$('#btn_remove_ssid').show();}});set_ssid_defaults(next_section_id);try{cbi_d_update('cbid.wireless.'+radio_idx+'.disabled');}catch(ex){}
var vap_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.disabled';$(vap_enable_id).change(function(){vap_enable_change(next_section_id);});vap_enable_change(next_section_id);var isolate_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.isolate';isolate_enable_change($(isolate_enabled_id).is(':checked'),next_section_id);$(isolate_enabled_id).change(function(){isolate_enable_change($(isolate_enabled_id).is(':checked'),next_section_id);});var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';encry_change(next_section_id);$(encryption_id).change(function(){encry_change(next_section_id);});var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';key_method_change(next_section_id);$(key_method_id).change(function(){key_method_change(next_section_id);});var macfilter_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.macfilter_enable';macfilter_enable_change($(macfilter_enabled_id).is(':checked'),next_section_id);$(macfilter_enabled_id).change(function(){macfilter_enable_change($(macfilter_enabled_id).is(':checked'),next_section_id);});var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';network_behavior_change(radio_idx,next_section_id);$(network_behavior_id).change(function(){network_behavior_change(radio_idx,next_section_id);});var limit_up_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';limit_up_enable_change($(limit_up_enabled_id).is(':checked'),next_section_id);$(limit_up_enabled_id).change(function(){limit_up_enable_change($(limit_up_enabled_id).is(':checked'),next_section_id);});var limit_down_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';limit_down_enable_change($(limit_down_enabled_id).is(':checked'),next_section_id);$(limit_down_enabled_id).change(function(){limit_down_enable_change($(limit_down_enabled_id).is(':checked'),next_section_id);});var hs20_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs20';$(hs20_enable_id).change(function(){hs20_enable_change($(hs20_enable_id).is(':checked'),next_section_id);});var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';$(radius_mac_acl_id).change(function(){radius_mac_acl_change($(radius_mac_acl_id).is(':checked'),next_section_id);});var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_auth_enable2';$(radius_auth_backup_enable_id).change(function(){radius_auth_backup_enable_change($(radius_auth_backup_enable_id).is(':checked'),next_section_id);});var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';$(dae_enable_id).change(function(){radius_dae_enable_change($(dae_enable_id).is(':checked'),next_section_id);});var radius_acct_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable';$(radius_acct_enable_id).change(function(){radius_acct_enable_change($(radius_acct_enable_id).is(':checked'),next_section_id);});var radius_acct_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';$(radius_acct_backup_enable_id).change(function(){radius_acct_backup_enable_change($(radius_acct_backup_enable_id).is(':checked'),next_section_id);});var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';var nasid_id='#cbid\\.wireless\\.'+radio_idx+'\\.nasid';$(auth_server_id).change(function(){clear_validate_error(auth_server_id);});$(auth_port_id).change(function(){clear_validate_error(auth_port_id);});$(auth_secret_id).change(function(){clear_validate_error(auth_secret_id);});$(nasid_id).change(function(){clear_validate_error(nasid_id);});var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radsec_enable';$(radsec_enable_id).change(function(){radius_radsec_enable_change($(radsec_enable_id).is(':checked'),next_section_id);});total_ssids_added++;set_btn_state();change_opmode();change_hwmode();cbi_init();});}
var active_id=1;function renumber_ssids(ssid_id){var last=true;for(i=ssid_id+1;i<=total_ssids_added;i++){if((i-1)<1){return;}
last=false;var old_tab_id='#SSID_tab_'+i;var old_tab_ssid=$(old_tab_id+' span').text();var new_tab_id='SSID_tab_'+(i-1);$('#SSID_tab_'+i).attr('id',new_tab_id);$('#'+new_tab_id).attr('data-ssidid',(i-1));$('#SSID'+i).attr('id','SSID'+(i-1));$('#'+new_tab_id+' a').attr('href','#SSID'+(i-1));var ssid_tab_html='<span>'+old_tab_ssid+'</span>&nbsp;(SSID'+(i-1)+')';$('#'+new_tab_id+' a').html(ssid_tab_html);}
active_id=ssid_id;if(last){active_id=ssid_id-1;}
$('#SSID_tab_'+(active_id)).addClass('active');$('#SSID'+(active_id)).addClass('active');}
function remove_ssid(){if($('#btn_remove_ssid').attr('disabled')=='disabled'){return;}
var ssid_id=$('#ssid_tabs li.active').first().data('ssidid');if(ssid_id!='1'){vap_enable_change(ssid_id,true);$('#SSID'+ssid_id).remove();$('#SSID_tab_'+ssid_id).remove();renumber_ssids(ssid_id);total_ssids_added--;set_btn_state();}}
function site_entity_control(idx){if(idx=='1'){$('#btn_remove_ssid').hide();}else{$('#btn_remove_ssid').show();}
if(sitelevel_ssid_status[idx-1]!=''){$('#btn_remove_ssid').attr('disabled','disabled');$('#btn_remove_ssid').attr('data-original-title',_('This item is managed by the cloud and cannot be deleted. Please disable it instead.'));}else{if(total_ssids_added>1){$('#btn_remove_ssid').removeAttr('disabled');$('#btn_remove_ssid').attr('data-original-title',_('Remove selected SSID'));}}}
function set_beacon_byVaps(){var beacon_val=parseInt($(beacon_id).val(),10);clear_validate_error($(beacon_id)[0]);$('#alert_vap8').hide();$('#alert_vap4').hide();if(total_ssids_enbaled_cnt<=3){beacon_min=beacon_default_min;if(beacon_val>beacon_min){$(beacon_id).val(beacon_val);}else{$(beacon_id).val(beacon_min);}}else if(total_ssids_enbaled_cnt>=4&&total_ssids_enbaled_cnt<=7){beacon_min=beacon_vap4_min;if(beacon_val<beacon_min){$('#alert_vap4').show();$(beacon_id).val(beacon_min);}else{$(beacon_id).val(beacon_val);}}else if(total_ssids_enbaled_cnt>=8){beacon_min=beacon_vap8_min;if(beacon_val<beacon_min){$('#alert_vap8').show();$(beacon_id).val(beacon_min);}else{$(beacon_id).val(beacon_val);}}}
function set_btn_state(last_entity_idx){if(total_ssids_added<max_ssids){$('#btn_add_ssid').removeAttr('disabled');$(mesh_enable).removeAttr('disabled');}else{$('#btn_add_ssid').attr('disabled','disabled');if($(mesh_enable).length&&!$(mesh_enable).is(':checked')){$(mesh_enable).attr('disabled','disabled');}
else{$(mesh_enable).removeAttr('disabled');}}
if(total_ssids_added<=1){$('#btn_remove_ssid').hide();}else{$('#btn_remove_ssid').removeAttr('disabled');$('#btn_remove_ssid').show();$('#btn_remove_ssid').attr('data-original-title',_('Remove selected SSID'));}
$('#btn_save').removeAttr('disabled');$('#btn_apply').removeAttr('disabled');$('#btn_add_ssid').attr('data-original-title',_('Add a new SSID (up to a max of %d)').format(max_ssids));}
function load_local_configurable_ssid(vap_idx){var radio_idx=radio_iface+'_'+vap_idx;var lc_enabled_radio_id_list=new Array();for(var k=0;k<lc_enabled_ids.length;k++){var lc_enabled_radio_id=radio_iface+'_'+lc_enabled_ids[k];lc_enabled_radio_id_list.push(lc_enabled_radio_id);}
if(lc_enabled_radio_id_list.includes(radio_idx)){$('#SSID_tab_'+vap_idx).addClass('show');$('#SSID'+vap_idx).addClass('show');}else{$('#SSID_tab_'+vap_idx).addClass('hidden');$('#SSID_tab_'+vap_idx).css('display','none');$('#SSID'+vap_idx).addClass('hidden');$('#SSID'+vap_idx).css('display','none');}}
function disabled_items(radio_idx,vap_idx,flag){var radio_idx=radio_iface+'_'+vap_idx;var lc_enabled_radio_id_list=new Array();for(var k=0;k<lc_enabled_ids.length;k++){var lc_enabled_radio_id=radio_iface+'_'+lc_enabled_ids[k];if(radio_idx==lc_enabled_radio_id){lc_enabled_radio_id_list.push(lc_enabled_radio_id);}}
if(mgmt_enabled&&(msp_disabled=='true'||(root_user=='true'&&lc_enabled_radio_id_list.length==0))){var pre_id='#cbid\\.wireless\\.'+radio_idx+'\\.';var change_items=new Array('disabled','ssid','hidden','nasid','isolate','wmm','blockmcast','local_configurable','maxassoc','max_inactivity','signal_stay','he_bss_color','chan_util_delta','encryption','key1','cipher','_wpa_key','key_method','_multi_key','sae_password','pmf','u8021p','ieee80211k','ieee80211w','ieee80211r','mobility_domain','kh_key_hex','ft_over_ds','Pairlist','auth_server','auth_port','auth_secret','acct_enable','acct_server','acct_port','acct_secret','acct_interval','acct_enable2','acct_server2','acct_port2','acct_secret2','eap_type','identity','password','macfilter_enable','macfilter','maclist','proxy_arp','limit_up_enable','limit_up','limit_down_enable','limit_down','network_behavior','vlan_network_name','network_name','default_vlan_behavior','dae_enable','dae_port','dae_secret','dae_client','radius_auth_enable2','auth_server2','auth_port2','auth_secret2','radius_mac_acl','radsec_enable','cloud_aaa','proxyarp','internet','hs20','hs20_profile','_hs20_profile','iw_internet','iw_access_network_type','iw_venue_group','iw_venue_name','iw_venue_type','iw_roaming_consortium','iw_ipaddr_ipv4_type_availability','iw_ipaddr_ipv6_type_availability','iw_nai_realm','iw_domain_name','iw_anqp_3gpp_cell_net','hs20_r2_enable','hessid','hs20_oper_friendly_name','hs20_operating_class','iw_portal_enable','iw_portal_url','iw_portal_wall','osu_ssid','osu_server_uri','osu_nai','osu_friendly_name','osu_service_desc','osen','deny_os');if(flag=='ap'){$('#ssid_action_buttons').addClass('hidden');$('#wifi_mgmt_notify_'+radio_idx).removeClass('hidden');$('#scan_btn_'+radio_idx).attr('disabled','disabled');$('#cbi-wireless-'+radio_idx+'-wallgardenbtn').attr('disabled','disabled');$('#hotspot_configure_btn_'+radio_idx).attr('disabled','disabled');$('#config_openroaming').attr('disabled','disabled');for(var i=0;i<change_items.length;i++){$(pre_id+change_items[i]).attr('disabled','disabled');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').attr('disabled','disabled');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').attr('style','background-color:#eee');$('.btn-dynamic').removeAttr('style').hide();}}else{$('#ssid_action_buttons').removeClass('hidden');$('#wifi_mgmt_notify_'+radio_idx).addClass('hidden');$('#scan_btn_'+radio_idx).removeAttr('disabled');$('#cbi-wireless-'+radio_idx+'-wallgardenbtn').removeAttr('disabled');$('#hotspot_configure_btn_'+radio_idx).removeAttr('disabled');for(var i=0;i<change_items.length;i++){$(pre_id+change_items[i]).removeAttr('disabled');$(pre_id+change_items[i]).removeAttr('style');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').removeAttr('disabled');$('input[name=cbid\\.wireless\\.'+radio_idx+'\\.'+change_items[i]+']').removeAttr('style');$('.btn-dynamic').show();}}}}
function change_opmode(){var radio_idx=radio_iface+'_1';var cipher_id='#cbid\\.wireless\\.'+radio_idx+'\\.cipher';var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var htmode_id=document.getElementById('cbid.wireless.'+radio_iface+'.htmode');var tkip_aes_option_id='cbi-wireless-'+radio_idx+'-cipher-tkip\\+ccmp';var macfilter_enabled_row_id='#cbi-wireless-'+radio_idx+'-macfilter_enable';var macfilter_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.macfilter_enable';var cli_isolation_id='#cbi-wireless-'+radio_idx+'-client_isolation';var limit_up_enabled_row_id='#cbi-wireless-'+radio_idx+'-limit_up_enable';var limit_up_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';var limit_down_enabled_row_id='#cbi-wireless-'+radio_idx+'-limit_down_enable';var limit_down_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';var hs20_enabled_row_id='#cbi-wireless-'+radio_idx+'-hs20';var tkip_aes_option='<option id="cbi-wireless-'+radio_idx+'-cipher-tkip+ccmp" value="tkip+ccmp">Auto: TKIP + CCMP (AES)</option>';var current_cipher=$(cipher_id).val();var current_encryption=$(encryption_id).val();var op_mode=$(mode_id).val();var ht_mode=$(htmode_id).val();if(op_mode.indexOf('sta')<0){if(ht_mode=='40'){$('#cbi-wireless-'+radio_iface+'-noscan').show();}else{$('#cbi-wireless-'+radio_iface+'-noscan').hide();}
$('#cbi-wireless-'+radio_iface+'-prc_disabled').show();$('#cbi-wireless-'+radio_iface+'-prc_remote_url').show();if(root_user=='true'||msp_disabled=='true'){$('#cbi-wireless-'+radio_iface+'-bandsteering').show();$('#cbi-wireless-'+radio_iface+'-atfpolicy').show();$('#cbi-wireless-'+radio_idx+'-maxassoc').show();$('#cbi-wireless-'+radio_idx+'-signal_stay').show();}
if(bandsteering_allowed){$('#cbid\\.wireless\\.'+radio_iface+'\\.bandsteering').removeAttr('disabled');}else{$('#cbid\\.wireless\\.'+radio_iface+'\\.bandsteering').attr('disabled','disabled');}
if(country_code=='OT'){$('#cbi-wireless-'+radio_iface+'-dfs').show();}else{$('#cbi-wireless-'+radio_iface+'-dfs').hide();}
$('#cbi-wireless-'+radio_idx+'-disabled').hide();if(has_ssid_status){$('#cbi-wireless-'+radio_idx+'-disabled').show();}
$('#wireless_title').text(_('Wireless Networks'));$('#ssidTabContent').css('background-color','white');$('#ssidTabContent').css('border','1px solid rgb(202, 202, 202)');if(!ssid_only_one){$('#ssid_tabs').show();$('#ssid_tabs').removeClass('hidden');$('#ssid_action_buttons').removeClass('hidden');}
$('#wireless_title').parent().css('margin-bottom','20px');$('.broadcast-checkbox').show();if(has_network_behavior){$('#cbi-wireless-'+radio_idx+'-network_behavior').removeClass('hidden');}else{$('#cbi-wireless-'+radio_idx+'-network_behavior').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-network_name').css('display','none');}
$('#'+radio_idx+'_wan_notify').addClass('hidden');$('#'+radio_idx+'_wan_change_notify').addClass('hidden');$('#'+radio_idx+'_wan_sta_notify').addClass('hidden');$('#'+radio_idx+'_reset_inet_src').val('0');$('#'+radio_idx+'_set_inet_src').val('0');var status_id=document.getElementById('cbid.wireless.'+radio_iface+'.disabled');if($(status_id).is(':checked')){if($('#'+radio_idx+'_wan_notify').attr('id')!=null){$('#'+radio_idx+'_wan_change_notify').removeClass('hidden');$('#'+radio_idx+'_reset_inet_src').val('1');}}
$(macfilter_enabled_row_id).show();macfilter_enable_change($(macfilter_enabled_id).is(':checked'),1);$(cli_isolation_id).show();if(root_user=='true'||msp_disabled=='true'){$(limit_up_enabled_row_id).show();$(limit_down_enabled_row_id).show();}
limit_up_enable_change($(limit_up_enabled_id).is(':checked'),1);limit_down_enable_change($(limit_down_enabled_id).is(':checked'),1);$('#cbi-wireless-'+radio_idx+'-CAPWAP_tunnel').removeClass('hidden');$('#cbi-wireless-'+radio_idx+'-cloud_aaa').removeClass('hidden');$('#cbi-advance-wmesh').removeClass('hidden');$('#cbi-wireless-'+radio_idx+'-key_method').show();security_method=$(encryption_id).val();var staWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa');var staWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2');var staWpa3Option=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa3');var staWpa3mixedOption=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa3-mixed');var apWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-wpa');var apWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-wpa2');var apWpa3Option=$('#cbi-wireless-'+radio_idx+'-encryption-wpa3');var apWpa3mixedOption=$('#cbi-wireless-'+radio_idx+'-encryption-wpa3-mixed');var apWpa3192Option=$('#cbi-wireless-'+radio_idx+'-encryption-wpa3-192');var apOweOption=$('#cbi-wireless-'+radio_idx+'-encryption-owe');if(staWpaOption.length!=0){staWpaOption.remove();}
if(staWpa2Option.length!=0){staWpa2Option.remove();}
if(staWpa3Option.length!=0){staWpa3Option.remove();}
if(staWpa3mixedOption.length!=0){staWpa3mixedOption.remove();}
if(apWpaOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-wpa',value:'wpa'}).text('WPA-EAP'));}
if(apWpa2Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-wpa2',value:'wpa2'}).text('WPA2-EAP'));}
if(apWpa3Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-wpa3',value:'wpa3'}).text('WPA3 Enterprise'));}
if(apWpa3mixedOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-wpa3-mixed',value:'wpa3-mixed'}).text('WPA3 Enterprise Transition'));}
if(apWpa3192Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-wpa3-192',value:'wpa3-192'}).text('WPA3 Enterprise 192-bit'));}
if(apOweOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-owe',value:'owe'}).text('OWE'));}
if(security_method!=undefined){var encryption_val="none";if(security_method=="wpa"){encryption_val="wpa";}else if(security_method=="sta-wpa"){encryption_val="wpa";}else if(security_method=="wpa2"){encryption_val="wpa2";}else if(security_method=="sta-wpa2"){encryption_val="wpa2";}else if(security_method=="psk"){encryption_val="psk";}else if(security_method=="psk2"){encryption_val="psk2";}else if(security_method=="sae"){encryption_val="sae";}else if(security_method=="sae-mixed"){encryption_val="sae-mixed";}else if(security_method=="wpa3"){encryption_val="wpa3";}else if(security_method=="sta-wpa3"){encryption_val="wpa3";}else if(security_method=="wpa3-mixed"){encryption_val="wpa3-mixed";}else if(security_method=="sta-wpa3-mixed"){encryption_val="wpa3-mixed";}else if(security_method=="wpa3-192"){encryption_val="wpa3-192";}else if(security_method=="owe"){encryption_val="owe";}
$('#cbid\\.wireless\\.'+radio_idx+'\\.encryption').val(encryption_val);$('#cbi-wireless-'+radio_idx+'-encryption-'+encryption_val).attr('selected','selected');}
if(root_user=='true'||msp_disabled=='true'){$('#cbi-wireless-'+radio_iface+'-_channel').show();}
$('#'+channel_id).prop('disabled',false);for(i=1;i<=max_ssids;i++){disabled_items(radio_id,i,'ap');$('#scan_btn_'+radio_iface+'_'+i).val(_('Site Survey'));var staWpaOption=$('#cbi-wireless-'+radio_iface+'_'+i+'-encryption-sta-wpa');var staWpa2Option=$('#cbi-wireless-'+radio_iface+'_'+i+'-encryption-sta-wpa2');var staWpa3Option=$('#cbi-wireless-'+radio_iface+'_'+i+'-encryption-sta-wpa3');var staWpa3mixedOption=$('#cbi-wireless-'+radio_iface+'_'+i+'-encryption-sta-wpa3-mixed');if(staWpaOption.length!=0){staWpaOption.remove();}
if(staWpa2Option.length!=0){staWpa2Option.remove();}
if(staWpa3Option.length!=0){staWpa3Option.remove();}
if(staWpa3mixedOption.length!=0){staWpa3mixedOption.remove();}
encry_change(i);key_method_change(i);}}else{for(i=1;i<=max_ssids;i++){disabled_items(radio_id,i,'sta_mode');$('#scan_btn_'+radio_iface+'_'+i).show();hs20_enable_change(false,i);}
$('#scan_btn_'+radio_idx+'').val('Scan');$('#cbi-wireless-'+radio_iface+'-prc_disabled').hide();$('#cbi-wireless-'+radio_iface+'-prc_remote_url').hide();$('#cbi-wireless-'+radio_iface+'-bandsteering').hide();$('#cbi-wireless-'+radio_iface+'-atfpolicy').hide();$('#cbi-wireless-'+radio_iface+'-noscan').hide();$('#cbi-wireless-'+radio_idx+'-signal_stay').hide();$('#cbi-wireless-'+radio_idx+'-maxassoc').hide();$('#cbi-wireless-'+radio_idx+'-key_method').hide();$('#cbi-wireless-'+radio_idx+'-ieee80211k').hide();$('#cbi-wireless-'+radio_idx+'-ieee80211r').hide();$('#cbi-wireless-'+radio_idx+'-key_method-psk').prop('selected','selected');$('#widget\\.cbid\\.wireless\\.'+radio_idx+'\\.signal_stay').val('-100');$('#cbi-wireless-'+radio_iface+'-dfs').hide();$('#cbi-wireless-'+radio_idx+'-disabled').hide();$('#cbid\\.wireless\\.'+radio_idx+'\\.disabled').prop('indeterminate',false).prop('checked',true);$('#ssidTabContent').children('div.tab-pane').removeClass('active');$('#ssidTabContent').children('div.tab-pane').first().addClass('active');$('#ssidTabContent').css('background-color','inherit');$('#wireless_title').text(_('Client Configuration'));$('#ssid_tabs').hide();$('#ssid_action_buttons').addClass('hidden');$('#wireless_title').parent().css('margin-bottom','0px');$('#ssidTabContent').css('border','0px solid rgb(202, 202, 202)');security_method=$(encryption_id).val();var staWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa');var staWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa2');var staWpa3Option=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa3');var staWpa3mixedOption=$('#cbi-wireless-'+radio_idx+'-encryption-sta-wpa3-mixed');var apWpaOption=$('#cbi-wireless-'+radio_idx+'-encryption-wpa');var apWpa2Option=$('#cbi-wireless-'+radio_idx+'-encryption-wpa2');var apWpa3Option=$('#cbi-wireless-'+radio_idx+'-encryption-wpa3');var apWpa3mixedOption=$('#cbi-wireless-'+radio_idx+'-encryption-wpa3-mixed');var apWpa3192Option=$('#cbi-wireless-'+radio_idx+'-encryption-wpa3-192');var apOweOption=$('#cbi-wireless-'+radio_idx+'-encryption-owe');if(apWpaOption.length!=0){apWpaOption.remove();}
if(apWpa2Option.length!=0){apWpa2Option.remove();}
if(apWpa3Option.length!=0){apWpa3Option.remove();}
if(apWpa3mixedOption.length!=0){apWpa3mixedOption.remove();}
if(apWpa3192Option.length!=0){apWpa3192Option.remove();}
if(apOweOption.length!=0){apOweOption.remove();}
if(staWpaOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-sta-wpa',value:'sta-wpa'}).text('WPA-EAP'));}
if(staWpa2Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-sta-wpa2',value:'sta-wpa2'}).text('WPA2-EAP'));}
if(staWpa3Option.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-sta-wpa3',value:'sta-wpa3'}).text('WPA3 Enterprise'));}
if(staWpa3mixedOption.length==0){$(encryption_id).append($('<option>',{id:'cbi-wireless-'+radio_idx+'-encryption-sta-wpa3-mixed',value:'sta-wpa3-mixed'}).text('WPA3 Enterprise Transition'));}
if(security_method!=undefined){var encryption_val="none";if(security_method=="wpa"){encryption_val="sta-wpa";}else if(security_method=="sta-wpa"){encryption_val="sta-wpa";}else if(security_method=="wpa2"){encryption_val="sta-wpa2";}else if(security_method=="sta-wpa2"){encryption_val="sta-wpa2";}else if(security_method=="psk"){encryption_val="psk";}else if(security_method=="psk2"){encryption_val="psk2";}else if(security_method=="sae"){encryption_val="sae";}else if(security_method=="sae-mixed"){encryption_val="sae-mixed";}else if(security_method=="wpa3"){encryption_val="sta-wpa3";}else if(security_method=="sta-wpa3"){encryption_val="sta-wpa3";}else if(security_method=="wpa3-mixed"){encryption_val="sta-wpa3-mixed";}else if(security_method=="sta-wpa3-mixed"){encryption_val="sta-wpa3-mixed";}
$('#cbid\\.wireless\\.'+radio_idx+'\\.encryption').val(encryption_val);$('#cbi-wireless-'+radio_idx+'-encryption-'+encryption_val).attr('selected','selected');}
$('#cbi-wireless-'+radio_idx+'-_multi_key').hide();$('.broadcast-checkbox').hide();$('#'+radio_idx+'_wan_notify').removeClass('hidden');$('#'+radio_idx+'_wan_change_notify').addClass('hidden');$('#'+radio_idx+'_reset_inet_src').val('0');$('#'+radio_idx+'_set_inet_src').val('0');if(previous_opmode.indexOf('sta')<0){var status_id=document.getElementById('cbid.wireless.'+radio_iface+'.disabled');if($(status_id).is(':checked')){$('#'+radio_idx+'_wan_sta_notify').removeClass('hidden');$('#'+radio_idx+'_set_inet_src').val('1');}
$('#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior').val('wan');$('#cbi-wireless-'+radio_idx+'-network_behavior').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-network_name').css('display','none');}
if(!has_network_behavior||($('#'+radio_idx+'_wan_notify').attr('id')!=null)){$('#cbi-wireless-'+radio_idx+'-network_behavior').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-network_name').css('display','none');}
$(macfilter_enabled_row_id).hide();$(macfilter_enabled_id).attr('checked',false);macfilter_enable_change(false,1);$(cli_isolation_id).hide();$(limit_up_enabled_row_id).show();$(limit_down_enabled_row_id).show();limit_up_enable_change($(limit_up_enabled_id).is(':checked'),1);limit_down_enable_change($(limit_down_enabled_id).is(':checked'),1);$(hs20_enabled_row_id).hide();$('#cbi-wireless-'+radio_idx+'-CAPWAP_tunnel').addClass('hidden');$('#cbi-wireless-'+radio_idx+'-cloud_aaa').addClass('hidden');$('#cbi-advance-wmesh').addClass('hidden');radius_change('hide','1');$('#cbi-wireless-'+radio_iface+'-_channel').hide();$('#'+channel_id).prop('disabled',true);}
$('#'+tkip_aes_option_id).remove();{$(cipher_id).append(tkip_aes_option);$(cipher_id).val(current_cipher);}
cbi_d_update('cbid.wireless.'+radio_idx+'.encryption');}
function set_ack_distance(){var time=$('#cbid\\.wireless\\.'+radio_iface+'\\.ack').val();if(time==null||time==undefined||time==0){$('#ack_miles').html(0);$('#ack_km').html(0);return;}
if(time<32||time>255){return;}
var km=(time-25)/6.7;var miles=km*0.621371192;$('#ack_miles').html(Math.round(miles*10)/10);$('#ack_km').html(Math.round(km*10)/10);}
function validate_network_behavior(radio_idx){return true;var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';if($(network_behavior_id).val()=='wan'&&wan_proto=='3g'&&$('#'+radio_idx+'_set_inet_src').val()!='1'&&$('#'+radio_iface+'_1_set_inet_src').val()!='1'){return false;}
return true;}
function default_vlan_behavior_change(radio_idx){var default_vlan_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.default_vlan_behavior';var vlan_option=$("#cbid\\.wireless\\."+radio_idx+"\\.vlan_network_name");var vlan_option=$("#cbid\\.wireless\\."+radio_idx+"\\.vlan_network_name");var vlan_id=vlan_option.find(":selected").val();var vlan_first_id=$("#cbi-wireless-"+radio_idx+"-vlan_network_name-");var vlan_untagged_id=$("#cbi-wireless-"+radio_idx+"-vlan_network_name-wan");var vlan_untagged_option='<option id="cbi-wireless-'+radio_idx+'-vlan_network_name-wan" value="wan">Untagged</option>';if($(default_vlan_behavior_id).val()=='accept'){if(vlan_untagged_id.length==0){var options=vlan_option.find("option").clone();vlan_option.find("option").remove();vlan_option.append(vlan_untagged_option);vlan_option.append(options);}
if(vlan_first_id.length){vlan_first_id.remove();}
if(vlan_id==''){vlan_option.find('option:eq(0)').attr('selected','selected');vlan_option.find('option:eq(1)').removeAttr('selected');}}}
function network_behavior_change(radio_idx,ssid_id){var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var bridge_error_alert='#'+radio_idx+'_wan_bridge_iface_error';var err_msg=_('This network behavior cannot be selected.');var vlan_option=$("#cbid\\.wireless\\."+radio_idx+"\\.vlan_network_name");var default_vlan_option=$("#cbid\\.wireless\\."+radio_idx+"\\.default_vlan_behavior");var vlan_id=vlan_option.find(":selected").val();var vlan_untagged_id=$("#cbi-wireless-"+radio_idx+"-vlan_network_name-wan");var vlan_untagged_option='<option id="cbi-wireless-'+radio_idx+'-vlan_network_name-wan" value="wan">Untagged</option>';var vlan_first_id=$("#cbi-wireless-"+radio_idx+"-vlan_network_name-");var vlan_first_option='<option id="cbi-wireless-'+radio_idx+'-vlan_network_name-" value="">Select a VLAN Id</option>';if($(network_behavior_id).val()=='vlan'){if(vlan_untagged_id.length){vlan_untagged_id.remove();}
if(vlan_option.find("option").length==0){vlan_option.append(vlan_first_option);}
else if(vlan_option.find("option").length>1&&vlan_first_id.length){vlan_first_id.remove();}
if(vlan_id=='wan'){vlan_option.find('option:eq(0)').attr('selected','selected');}}else if($(network_behavior_id).val()=='dynamic_vlan'){default_vlan_behavior_change(radio_idx);$("#cbid\\.wireless\\."+radio_idx+"\\.default_vlan_behavior").change(function(){default_vlan_behavior_change(radio_idx);});}else if($(network_behavior_id).val()=='wan'){if(wan_proto=='3g'&&$('#'+radio_idx+'_set_inet_src').val()!='1'&&$('#'+radio_iface+'_1_set_inet_src').val()!='1'){set_err_msg(network_behavior_id,true,err_msg);$(bridge_error_alert).removeClass('hidden');}else{set_err_msg(network_behavior_id,false,err_msg);$(bridge_error_alert).addClass('hidden');}}else{set_err_msg(network_behavior_id,false,err_msg);$(bridge_error_alert).addClass('hidden');}
var isolate_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.isolate';isolate_enable_change($(isolate_enabled_id).is(':checked'),ssid_id);}
function limit_up_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var limit_up_row_id='#cbi-wireless-'+radio_idx+'-limit_up';var limit_up_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up';if(_enabled){$(limit_up_id).removeAttr('disabled');$(limit_up_row_id).show();}else{$(limit_up_row_id).hide();$(limit_up_id).attr('disabled','disabled');}}
function limit_down_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var limit_down_row_id='#cbi-wireless-'+radio_idx+'-limit_down';var limit_down_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down';if(_enabled){$(limit_down_id).removeAttr('disabled');$(limit_down_row_id).show();}else{$(limit_down_row_id).hide();$(limit_down_id).attr('disabled','disabled');}}
function capwap_tunnel_split(ssid_id,_func){var radio_idx=radio_iface+'_'+ssid_id;var CAPWAP_tunnel='#cbid\\.wireless\\.'+radio_idx+'\\.CAPWAP_tunnel';if($(CAPWAP_tunnel).val()=='1'){$('#cbid\\.wireless\\.'+radio_idx+'\\.acct_interval').attr('disabled','disabled');if(_func=='lock'){var pre_id='#cbid\\.wireless\\.'+radio_idx+'\\.';var lock_items=new Array('auth_server','auth_port','auth_secret','radius_auth_enable2','auth_server2','auth_port2','auth_secret2','acct_enable','acct_server','acct_port','acct_secret','acct_enable2','acct_server2','acct_port2','acct_secret2','radius_mac_acl','radsec_enable','dae_enable','dae_port','dae_client','dae_secret','nasid');for(var i=0;i<lock_items.length;i++){$(pre_id+lock_items[i]).attr('disabled','disabled');}}}}
function encry_change(ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var dynamic_option_id='#cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan';var dynamic_option='<option id="cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan" value="dynamic_vlan">'+_('Dynamic VLAN')+'</option>';var dae_enable_id=$('#cbi-wireless-'+radio_idx+'-dae_enable');var hs20_row_id='#cbi-wireless-'+radio_idx+'-hs20';var btn_hs20_row_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs20';var val=$(encryption_id).val();var nbh_val=$(network_behavior_id).val();$(dynamic_option_id).remove();var mode_id=document.getElementsByName('cbid.wireless.'+radio_iface+'.mode');var op_mode=mode_id[0].value;if(op_mode.indexOf('sta')<0){disabled_items(radio_id,ssid_id,'ap');var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';var km_val=$(key_method_id).val();if(val=='psk2'){$('#cbi-wireless-'+radio_idx+'-key_method-mpsk').show();$('#cbi-wireless-'+radio_idx+'-key_method-dpsk').show();}
else if(val=='psk'){$('#cbi-wireless-'+radio_idx+'-key_method-mpsk').show();$('#cbi-wireless-'+radio_idx+'-key_method-dpsk').hide();if(km_val=='dpsk'){$('#cbi-wireless-'+radio_idx+'-key_method-'+km_val).hide();$(key_method_id).val('psk');}}else{$('#cbi-wireless-'+radio_idx+'-key_method-mpsk').hide();$('#cbi-wireless-'+radio_idx+'-key_method-dpsk').hide();if(km_val=='mpsk'||km_val=='dpsk'){$('#cbi-wireless-'+radio_idx+'-key_method-'+km_val).hide();$(key_method_id).val('psk');}}
key_method_change(ssid_id);$(key_method_id).change(function(){event.preventDefault();key_method_change(ssid_id);});if(val=='wpa'||val=='wpa2'||val=='wpa3'||val=='wpa3-mixed'||val=='wpa3-192'){var radius_mac_acl_row_id='#cbi-wireless-'+radio_idx+'-radius_mac_acl';var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var radsec_enable_rowid=$('#cbi-wireless-'+radio_idx+'-radsec_enable');$(radius_mac_acl_row_id).hide();dae_enable_id.show();radius_dae_enable_change(true,ssid_id);radsec_enable_rowid.show();radius_radsec_enable_change($(radsec_enable_id).is(':checked'),ssid_id);$('#cbi-wireless-'+radio_idx+'-auth_server').show();$('#cbi-wireless-'+radio_idx+'-auth_port').show();$('#cbi-wireless-'+radio_idx+'-auth_secret').show();$('#cbi-wireless-'+radio_idx+'-nasid').show();$(network_behavior_id).append(dynamic_option);}
var hs20_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs20';if(val=='wpa2'){if(!mgmt_enabled){$(btn_hs20_row_id).removeAttr("disabled");}
$(btn_hs20_row_id).attr("value","1");hs20_enable_change($(hs20_enable_id).is(':checked'),ssid_id);}else{$(btn_hs20_row_id).attr("disabled","disabled");$(btn_hs20_row_id).attr("value","0");hs20_enable_change(false,ssid_id);}
var pmf_disable_option_id='cbi-wireless-'+radio_idx+'-ieee80211w-0';var pmf_disable_option='<option id="cbi-wireless-'+radio_idx+'-ieee80211w-0" value="0">'+_('Disabled')+'</option>';var current_pmf=$('#cbid\\.wireless\\.'+radio_idx+'\\.ieee80211w').val();$('#'+pmf_disable_option_id).remove();if(val=='psk2'||val=='wpa2'){var pmf_id='#cbid\\.wireless\\.'+radio_idx+'\\.ieee80211w';$(pmf_id).append(pmf_disable_option);sort_select_option(pmf_id);$(pmf_id).val(current_pmf);}
radius_change('show',ssid_id);$(network_behavior_id).val(nbh_val);}else{disabled_items(radio_id,ssid_id,'sta_mode');radius_change('hide',ssid_id);$('#cbi-wireless-'+radio_idx+'-key_method').hide();if(val=='psk'||val=='psk2'||val=='sae'||val=='sae-mixed'){$('#cbi-wireless-'+radio_idx+'-_wpa_key').show();}
else{$('#cbi-wireless-'+radio_idx+'-_wpa_key').hide();}
$('#cbi-wireless-'+radio_idx+'-ieee80211k').hide();$('#cbi-wireless-'+radio_idx+'-ieee80211r').hide();if(val=='sae-mixed'){var pmf_disable_option_id='cbi-wireless-'+radio_idx+'-ieee80211w-0';$('#'+pmf_disable_option_id).remove();}}
capwap_tunnel_split(ssid_id,'lock');$(encryption_id).val(val);}
function key_method_change(ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';var key_method_val=$(key_method_id).val();var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var encryption_val=$(encryption_id).val();var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';if(key_method_val=='psk'||key_method_val=='mpsk'){$('#cbi-wireless-'+radio_idx+'-_wpa_key').show();}
else{$('#cbi-wireless-'+radio_idx+'-_wpa_key').hide();}
if(key_method_val=='mpsk'){$('#cbi-wireless-'+radio_idx+'-_multi_key').show();$('#cbid\\.wireless\\.'+radio_idx+'\\._multi_key').attr("disabled",false);}else{$('#cbi-wireless-'+radio_idx+'-_multi_key').hide();$('#cbid\\.wireless\\.'+radio_idx+'\\._multi_key').attr("disabled",true);}
if(key_method_val=='dpsk'){$('#cbi-wireless-'+radio_idx+'-radius_mac_acl').hide();$('#cbi-wireless-'+radio_idx+'-macfilter_enable').hide();$('#cbi-wireless-'+radio_idx+'-auth_server').show();$('#cbi-wireless-'+radio_idx+'-auth_port').show();$('#cbi-wireless-'+radio_idx+'-auth_secret').show();$('#cbi-wireless-'+radio_idx+'-radius_auth_enable2').show();}
else{if(encryption_val=='wpa'||encryption_val=='wpa2'||encryption_val=='wpa3'||encryption_val=='wpa3-mixed'||encryption_val=='wpa3-192'||$(radius_mac_acl_id).is(':checked')){}else{$('#cbi-wireless-'+radio_idx+'-radius_mac_acl').show();$('#cbi-wireless-'+radio_idx+'-macfilter_enable').show();$('#cbi-wireless-'+radio_idx+'-auth_server').hide();$('#cbi-wireless-'+radio_idx+'-auth_port').hide();$('#cbi-wireless-'+radio_idx+'-auth_secret').hide();$('#cbi-wireless-'+radio_idx+'-nasid').hide();$('#cbi-wireless-'+radio_idx+'-radius_auth_enable2').hide();}}}
function vap_enable_change(ssid_id,is_remove,is_init){var radio_idx=radio_iface+'_'+ssid_id;var vap_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.disabled';var vap_enabled=($(vap_enable_id).is(':checked'))
if(is_init){if(vap_enabled){total_ssids_enbaled_cnt++;}}else{if(is_remove&&vap_enabled){total_ssids_enbaled_cnt--;}
if(!is_remove){if(vap_enabled){total_ssids_enbaled_cnt++;}else{total_ssids_enbaled_cnt--;}}}
set_beacon_byVaps();}
var CH_40m=new Array(36,44,52,60,68,76,84,92,100,108,116,124,132,140,149,157,165,173);var CH_80m=new Array(36,52,68,84,100,116,132,149,165,179);var chnl_list_ori=[];var chnl_list=[];var removed_channel=[];function get_channel_arr(_arr){$('#'+channel_id+' option').each(function(){if($.isNumeric(this.value)){_arr.push(this.value);}});}
function is80MChannel(chnl_list,chnl_num,channel){var idx;var chNO;var baseCH=0,MAX_NUM_80M_CH=CH_80m.length;if((CH_80m[MAX_NUM_80M_CH-1]<=channel)&&((CH_80m[MAX_NUM_80M_CH-1]+8)>=channel)){baseCH=CH_80m[MAX_NUM_80M_CH-1];}else{for(chNO=0;chNO<MAX_NUM_80M_CH-1;chNO++){if(CH_80m[chNO]<=channel&&CH_80m[chNO+1]>channel){baseCH=CH_80m[chNO];break;}}}
if(baseCH===0){}
for(idx=0;idx<chnl_num;idx++){if(chnl_list[idx]==baseCH){break;}}
if(idx==chnl_num||idx+3>=chnl_num){return false;}
if(baseCH>=165){if(idx+5>=chnl_num){return false;}
if(chnl_list[idx+1]==baseCH+4&&chnl_list[idx+3]==baseCH+8&&chnl_list[idx+5]==baseCH+12){return true;}}
if(chnl_list[idx+1]==baseCH+4&&chnl_list[idx+2]==baseCH+8&&chnl_list[idx+3]==baseCH+12){return true;}else{return false;}}
function is40MChannel(chnl_list,chnl_num,channel){var idx;var chNO;var baseCH=0,MAX_NUM_40M_CH=CH_40m.length;if((CH_40m[MAX_NUM_40M_CH-1]<=channel)&&((CH_40m[MAX_NUM_40M_CH-1]+4)>=channel)){baseCH=CH_40m[MAX_NUM_40M_CH-1];}else{for(chNO=0;chNO<MAX_NUM_40M_CH-1;chNO++){if(CH_40m[chNO]<=channel&&CH_40m[chNO+1]>channel){baseCH=CH_40m[chNO];break;}}}
if(baseCH===0){}
for(idx=0;idx<chnl_num;idx++){if(chnl_list[idx]==baseCH){break;}}
if(idx===chnl_num||idx+1>=chnl_num){return false;}
if(chnl_list[idx+1]==baseCH+4){return true;}else{return false;}}
function validateWall(idx){var res=true;var walled_id='#cbid\\.wireless\\.'+idx+'\\.hs_wall';var walledbtn_id='#cbi-wireless-'+idx+'-wallgardenbtn';if($(walled_id).val()!=''){clear_validate_error(walled_id);$(walled_id).val(convert_list($(walled_id).val()));var tmp_arr=$(walled_id).val().split(' ');if(tmp_arr.length>max_list_walled){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,_('The total Walled Garden List is up to %d.').format(max_list_walled));set_err_msg($(walledbtn_id),true,'');res=false;}else{var cidrToSubnets=['0.0.0.0','128.0.0.0','192.0.0.0','224.0.0.0','240.0.0.0','248.0.0.0','252.0.0.0','254.0.0.0','255.0.0.0','255.128.0.0','255.192.0.0','255.224.0.0','255.240.0.0','255.248.0.0','255.252.0.0','255.254.0.0','255.255.0.0','255.255.128.0','255.255.192.0','255.255.224.0','255.255.240.0','255.255.248.0','255.255.252.0','255.255.254.0','255.255.255.0','255.255.255.128','255.255.255.192','255.255.255.224','255.255.255.240','255.255.255.248','255.255.255.252','255.255.255.254','255.255.255.255'];for(var i=0;i<tmp_arr.length;i++){if(tmp_arr[i].search('/')!=-1){var ip_netmask=tmp_arr[i].split('/');if(ip_netmask.length>2){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,_('Some of walled garden addresses are invalid'));set_err_msg($(walledbtn_id),true,'');return false;}
var _ip=ip_netmask[0];var _netmask=cidrToSubnets[ip_netmask[1]];if(!is_ip(_ip)){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,_('Not a valid IPv4 address!')+'('+_ip+')');set_err_msg($(walledbtn_id),true,'');return false;}
if(_netmask==undefined||!cbi_validators.netmask(_netmask)){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,_('Not a valid netmask!')+'('+ip_netmask[1]+')');set_err_msg($(walledbtn_id),true,'');return false;}
if(is_broadcast(_ip,_netmask)){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,_('IP address is a broadcast IP.')+'('+_ip+')');set_err_msg($(walledbtn_id),true,'');return false;}}else{if(!cbi_validators.host(tmp_arr[i])){$(walled_id).css('border-color','#f09784');set_err_msg($(walled_id),true,_('Some of walled garden addresses are invalid'));set_err_msg($(walledbtn_id),true,'');return false;}}}}
if(res){clear_validate_error(walled_id);clear_validate_error(walledbtn_id);$(walled_id).css('border-color','');}}
return res;}
function validate_radius_backup(idx){var res_server=true;var res_port=true;var res_secret=true;var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+idx+'\\.radius_auth_enable2';var auth_server_id='#cbid\\.wireless\\.'+idx+'\\.auth_server2';var auth_port_id='#cbid\\.wireless\\.'+idx+'\\.auth_port2';var auth_secret_id='#cbid\\.wireless\\.'+idx+'\\.auth_secret2';clear_validate_error(auth_server_id);clear_validate_error(auth_port_id);clear_validate_error(auth_secret_id);if($(radius_auth_backup_enable_id).is(':checked')){if(!cbi_validators.host($(auth_server_id).val(),LOOPBACK_IP_OK)){set_err_msg($(auth_server_id),true,_('Not a valid IPv4 address!'));res_server=false;}
if($(auth_port_id).val()===''||(!is_in_range($(auth_port_id).val(),port_min,port_max))){set_err_msg($(auth_port_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(port_min,port_max));res_port=false;}
var _val=$(auth_secret_id).val();if(_val===''||!(typeof _val==='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(auth_secret_id),true,_('This value must be between %d and %d characters long.').format(1,200));res_secret=false;}}else{$(auth_server_id).val('');$(auth_port_id).val('');$(auth_secret_id).val('');}
return(res_server&&res_port&&res_secret);}
function validate_list(radio_idx,listname){var id_tmp='cbid.wireless.'+radio_idx+'.'+listname;var get_id=document.getElementById(id_tmp);if(get_id){var current_mac_cnt=0;clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.'+listname);var tmp_walled_str=get_id.value.replace(/\r\n|\r|\n/g,';');tmp_walled_str=tmp_walled_str.replace(/(^\s*)|(\s*$)/g,'');var tmp_arr1=tmp_walled_str.split(';');for(var j=0;j<tmp_arr1.length;j++){if(tmp_arr1[j]==''){continue;}
current_mac_cnt++;var tmp_arr2=tmp_arr1[j].split(' ');if(!is_mac(tmp_arr2[0])){set_err_msg(get_id,true,_('Not a valid MAC address!')+'('+tmp_arr2[0]+')');$(get_id).addClass('cbi-input-invalid');return'err_mac';}}
if(listname=='Pairlist'&&current_mac_cnt>max_Pairlist){set_err_msg(get_id,true,_('The total pairs are up to %d.').format(max_Pairlist));$(get_id).addClass('cbi-input-invalid');return'err_cnt';}
if(current_mac_cnt>max_list){set_err_msg(get_id,true,_('The total Filtered MACs are up to %d.').format(max_list));$(get_id).addClass('cbi-input-invalid');return'err_cnt';}}}
function validate_multi_key(_key){var check_key=true;if(_key==''){check_key=true;}else if(!wpakey(_key)){check_key=false;}
return check_key;}
function validate_multi_mac(_mac){var check_mac=true;if(_mac==undefined||_mac==''){check_mac=true;}else if(!is_mac(_mac)){check_mac=false;}
return check_mac;}
function delBlankLines(_val){var stringArray=_val.split('\n');var temp=[''];var j=0;for(var i=0;i<stringArray.length;i++){if(stringArray[i].trim()!=''){temp[j]=stringArray[i];j++;}}
temp=temp.join('\n');return temp;}
var beacon_default_min=100;var beacon_default_max=1024;var beacon_vap4_min=250;var beacon_vap8_min=500;var beacon_min=beacon_default_min;var beacon_max=beacon_default_max;function validate_form(){var err_ssid=false;var err_wpa_key=false;var err_wpa_mac=false;var res_beacon=true;var res_mesh_id=true;var res_mesh_key=true;var err_min_signal_allowed=false;var err_he_bss_color=false;var err_chan_util_delta=false;var err_mac=false;var err_cnt=false;var err_walled=false;var flag_radius=false;var flag_dae=false;var flag_duplicate_ssid=false;var network_behavior=false;var flag_hs20=false;var flag_limit_down_up=false;var err_mesh=false;var ssid_arr=new Array();var ssid_duplicate_arr=new Array(max_ssids);var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var op_mode=$(mode_id).val();var err_he_bss_color=false;var err_ssid_id=0;var current_multiKey_cnt=0;res_beacon=verify_beacon();res_mesh_id=verify_mesh_id();res_mesh_key=verify_mesh_key();var check_hwmode=document.getElementById('cbid.wireless.'+radio_iface+'.hwmode');var check_mode_val=$(check_hwmode).val();var he_bss_color_id='#cbid\\.wireless\\.'+radio_iface+'\\.he_bss_color';clear_validate_error($(he_bss_color_id));if($(he_bss_color_id).length!=0&&($(he_bss_color_id).val()==''||(!is_in_range($(he_bss_color_id).val(),1,64)))){set_err_msg($(he_bss_color_id),true,'');err_he_bss_color=true;}
var chan_util_delta_id='#cbid\\.wireless\\.'+radio_iface+'\\.chan_util_delta';clear_validate_error($(chan_util_delta_id)[0]);if($(chan_util_delta_id).val()==''||(!is_in_range($(chan_util_delta_id).val(),0,99))){set_err_msg($(chan_util_delta_id),true,'');err_chan_util_delta=true;}
if(!res_beacon||!res_mesh_id||!res_mesh_key||err_he_bss_color||err_chan_util_delta){return false;}
for(var i=1;i<=total_ssids_added;i++){var radio_idx=radio_iface+'_'+i;if(op_mode.indexOf('ap')>=0){var ssid_id='cbid.wireless.'+radio_idx+'.ssid';var get_ssid_id=document.getElementById(ssid_id);if(get_ssid_id&&get_ssid_id.value!=''){clear_validate_error(get_ssid_id);for(var j=0;j<ssid_arr.length;j++){if(get_ssid_id.value==ssid_arr[j]){ssid_duplicate_arr[j]=true;ssid_duplicate_arr[i-1]=true;flag_duplicate_ssid=true;err_ssid_id=i;}}
ssid_arr.push(get_ssid_id.value);}
if(get_ssid_id&&($(get_ssid_id).val()==''||(!is_in_range($(get_ssid_id).val().length,1,32)))){set_err_msg($(get_ssid_id),true,_('This field is required.'));err_ssid=true;err_ssid_id=i;}}
var wpa_key_id='cbid.wireless.'+radio_idx+'._wpa_key';var get_wpa_key=document.getElementById(wpa_key_id);if(get_wpa_key&&($(get_wpa_key).val()==''||(!wpakey($(get_wpa_key).val())))){err_ssid_id=i;}
var _multi_key_id='#cbid\\.wireless\\.'+radio_idx+'\\._multi_key';var _multi_key_val=$(_multi_key_id).val();var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';var key_method_val=$(key_method_id).val();clear_validate_error(_multi_key_id);if(key_method_val=="mpsk"&&_multi_key_val!=undefined&&_multi_key_val!=''){new_val=delBlankLines(_multi_key_val);_multi_key_val=new_val
$(_multi_key_id).val(new_val);var _multi_key_val_line=_multi_key_val.split('\n');if(_multi_key_val_line.length<=max_multikey){for(var k=0;k<_multi_key_val_line.length;k++){current_multiKey_cnt++;var key_mac=_multi_key_val_line[k].split(' ');var _key=key_mac[0];var _mac=key_mac[1];if(_key==''||!validate_multi_key(_key)){set_err_msg($(_multi_key_id),true,_('Not a valid WPA key! Value must be between 8 and 63 ASCII (letters and numbers) characters long or 64 Hex characters.'));err_wpa_key=true;err_ssid_id=i;}
if(!validate_multi_mac(_mac)){set_err_msg($(_multi_key_id),true,_('Not a valid MAC address!')+'('+_mac+')');$(_multi_key_id).addClass('cbi-input-invalid');err_wpa_mac=true;err_ssid_id=i;}}}
else{set_err_msg($(_multi_key_id),true,_('The total Multiple Keys are up to %d.').format(max_multikey));err_wpa_key=true;err_ssid_id=i;}
if(current_multiKey_cnt>max_multikeylist){set_err_msg($(_multi_key_id),true,_('The total Mutiple Keys per Radio are up to %d.').format(max_multikeylist));err_wpa_key=true;err_ssid_id=i;}}
var min_signal_allowed_id='#cbid\\.wireless\\.'+radio_idx+'\\.signal_stay';var min_signal_allowed_val=$(min_signal_allowed_id).val();clear_validate_error(min_signal_allowed_id);if(min_signal_allowed_val!=undefined&&(min_signal_allowed_val==''||(!is_in_range_negative(min_signal_allowed_val,-100,-1)))){set_err_msg($(min_signal_allowed_id),true,_('Allowed values are integers between %d and %d, inclusive.').format(-100,-1));err_min_signal_allowed=true;err_ssid_id=i;}
var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';var nasid_id='#cbid\\.wireless\\.'+radio_idx+'\\.nasid';var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var encryption_val=$(encryption_id).val();var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';var key_method_val=$(key_method_id).val();clear_validate_error(auth_server_id);clear_validate_error(auth_port_id);clear_validate_error(auth_secret_id);clear_validate_error(nasid_id);if($(radius_mac_acl_id).is(':checked')||(encryption_val=='wpa'||encryption_val=='wpa2'||encryption_val=='wpa3'||encryption_val=='wpa3-mixed'||encryption_val=='wpa3-192')||(encryption_val=='psk2'&&key_method_val=='dpsk')){if(!cbi_validators.host($(auth_server_id).val(),LOOPBACK_IP_OK)){set_err_msg($(auth_server_id),true,_('Not a valid host or IP address!'));flag_radius=true;err_ssid_id=i;}
if($(auth_port_id).val()==''||(!is_in_range($(auth_port_id).val(),port_min,port_max))){set_err_msg($(auth_port_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(port_min,port_max));flag_radius=true;err_ssid_id=i;}
var _val=$(auth_secret_id).val();if(_val==''||!(typeof _val=='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(auth_secret_id),true,_('This value must be between %d and %d characters long.').format(1,200));flag_radius=true;err_ssid_id=i;}
var nasid_val=$(nasid_id).val();if(nasid_val!=''&&!(typeof nasid_val=='string'&&nasid_val.length>=1&&nasid_val.length<=48)){set_err_msg($(nasid_id),true,_('This value must be between %d and %d characters long.').format(1,48));flag_radius=true;err_ssid_id=i;}}
var acct_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_server';var acct_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_port';var acct_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret';var acct_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable';var acct_interval_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_interval';clear_validate_error(acct_server_id);clear_validate_error(acct_port_id);clear_validate_error(acct_secret_id);clear_validate_error(acct_interval_id);if($(acct_enable_id).is(':checked')){if(!is_ip($(acct_server_id).val())){set_err_msg($(acct_server_id),true,_('Not a valid IPv4 address!'));flag_radius=true;err_ssid_id=i;}
if($(acct_interval_id).val()===''||(!is_in_range($(acct_interval_id).val(),60,600))){set_err_msg($(acct_interval_id),true,_('Allowed values are integers between %d and %d, inclusive.').format(60,600));flag_radius=true;err_ssid_id=i;}
if($(auth_port_id).val()==''||(!is_in_range($(auth_port_id).val(),port_min,port_max))){set_err_msg($(auth_port_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(port_min,port_max));flag_radius=true;err_ssid_id=i;}
var _val=$(acct_secret_id).val();if(_val==''||!(typeof _val=='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(acct_secret_id),true,_('This value must be between %d and %d characters long.').format(1,200));flag_radius=true;err_ssid_id=i;}}
var acct_server2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_server2';var acct_port2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_port2';var acct_secret2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret2';var acct_enable2_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';clear_validate_error(acct_server2_id);clear_validate_error(acct_port2_id);clear_validate_error(acct_secret2_id);if($(acct_enable2_id).is(':checked')){if(!is_ip($(acct_server2_id).val())){set_err_msg($(acct_server2_id),true,_('Not a valid IPv4 address!'));flag_radius=true;err_ssid_id=i;}
if($(acct_port_id).val()===''||(!is_in_range($(acct_port2_id).val(),port_min,port_max))){set_err_msg($(acct_port2_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(port_min,port_max));flag_radius=true;err_ssid_id=i;}
var _val=$(acct_secret2_id).val();if(_val===''||!(typeof _val==='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(acct_secret2_id),true,_('This value must be between %d and %d characters long.').format(1,200));flag_radius=true;err_ssid_id=i;}}
var maclist_result=validate_list(radio_idx,'maclist');var Pairlist_result=validate_list(radio_idx,'Pairlist');if(maclist_result=='err_mac'||Pairlist_result=='err_mac'){err_mac=true;err_ssid_id=i;}
if(maclist_result=='err_cnt'||Pairlist_result=='err_cnt'){err_cnt=true;err_ssid_id=i;}
if(!validateWall(radio_idx)){err_walled=true;err_ssid_id=i;}
if(!validate_radius_backup(radio_idx)){flag_radius=true;err_ssid_id=i;}
if(!validate_radius_dae(radio_idx)){flag_dae=true;err_ssid_id=i;}
if(!validate_network_behavior(radio_idx)){network_behavior=true;err_ssid_id=i;}
var limit_up_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';var limit_up_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up';var limit_down_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';var limit_down_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down';clear_validate_error(limit_up_id);clear_validate_error(limit_down_id);if($(limit_up_enabled_id).is(':checked')){if($(limit_up_id).val()===''||(!is_in_range($(limit_up_id).val(),256,10048576))){set_err_msg($(limit_up_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(256,10048576));flag_limit_down_up=true;err_ssid_id=i;}}
if($(limit_down_enabled_id).is(':checked')){if($(limit_down_id).val()===''||(!is_in_range($(limit_down_id).val(),256,10048576))){set_err_msg($(limit_down_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(256,10048576));flag_limit_down_up=true;err_ssid_id=i;}}
if(err_ssid_id!=0){$('#SSID_tab_'+err_ssid_id+' a').css('color','#f09784');}}
if(op_mode.indexOf('ap')>=0){if(flag_duplicate_ssid){for(var i=1;i<=max_ssids;i++){if(ssid_duplicate_arr[i-1]){var _tmp='#cbid\\.wireless\\.'+radio_iface+'_'+i+'\\.ssid';set_err_msg(_tmp,true,_('Duplicated SSID'));}}}}
var channel_id='#cbid\\.wireless\\.'+radio_iface+'\\.channel';var channel_val=$(channel_id).val();var channel_btn_id='#frequency_btn_'+radio_iface;clear_validate_error(channel_btn_id);if($(mesh_enable).is(':checked')){if($.isNumeric(channel_val)==false){set_err_msg($(channel_btn_id),true,'');$('#wifi_frequency_error_msg').text(_('Only one channel can be selected when enable open mesh!'));$('#wifi_frequency_error_msg_placeholder').removeClass('hide');err_mesh=true;}}
if(err_ssid||err_min_signal_allowed||err_wpa_key||err_wpa_mac||err_mac||err_cnt||err_walled||flag_radius||flag_duplicate_ssid||flag_dae||network_behavior||flag_limit_down_up||flag_hs20||err_mesh){return false;}
for(var i=1;i<=total_ssids_added;i++){var radio_idx=radio_iface+'_'+i;var min_signal_allowed_id='#cbid\\.wireless\\.'+radio_idx+'\\.signal_stay';if($(min_signal_allowed_id).length){var min_signal_allowed_val=$(min_signal_allowed_id).val();min_signal_allowed_val=parseInt(min_signal_allowed_val)+100;$(min_signal_allowed_id).val(min_signal_allowed_val);}}
return true;}
function validate_radius_dae(idx){var res_server=true;var res_port=true;var res_secret=true;var dae_enable_id='#cbid\\.wireless\\.'+idx+'\\.dae_enable';var dae_client_id='#cbid\\.wireless\\.'+idx+'\\.dae_client';var dae_port_id='#cbid\\.wireless\\.'+idx+'\\.dae_port';var dae_secret_id='#cbid\\.wireless\\.'+idx+'\\.dae_secret';var dae_port=$(dae_port_id).val();clear_validate_error(dae_client_id);clear_validate_error(dae_port_id);clear_validate_error(dae_secret_id);if($(dae_enable_id).is(':checked')){if(!is_ip($(dae_client_id).val())){set_err_msg($(dae_client_id),true,_('Not a valid IPv4 address!'));res_server=false;}
if(dae_port===''||(!is_in_range($(dae_port_id).val(),port_min,port_max))){set_err_msg($(dae_port_id),true,_('Not a valid port range! Allowed values are integers between %d and %d, inclusive.').format(port_min,port_max));res_port=false;}
if(!jQuery.isEmptyObject(dae_ports)){for(const property in dae_ports){if(property!=idx&&dae_ports[property]==dae_port){set_err_msg($(dae_port_id),true,_('Duplicated port'));res_port=false;}}
if(dae_port!==undefined){dae_ports[idx]=dae_port;}}
else{if(dae_port!==undefined){dae_ports[idx]=dae_port;}}
var _val=$(dae_secret_id).val();if(_val===''||!(typeof _val==='string'&&_val.length>=1&&_val.length<=200)){set_err_msg($(dae_secret_id),true,_('This value must be between %d and %d characters long.').format(1,200));res_secret=false;}}else{$(dae_client_id).val('');$(dae_port_id).val('');$(dae_secret_id).val('');}
return(res_server&&res_port&&res_secret);}
function convert_list(val){var tmp_walled_str=val.replace(/\r\n|\r|\n/g,' ');tmp_walled_str=tmp_walled_str.replace(/(^\s*)|(\s*$)/g,'');tmp_walled_str=tmp_walled_str.replace(/\s+/g,' ');return tmp_walled_str;}
function radius_radsec_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';var auth_backup_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port2';var auth_backup_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret2';if(_enabled){if($(auth_port_id).val()=='1812')
$(auth_port_id).val('2083');if($(auth_secret_id).val()=='')
$(auth_secret_id).val('radsec');if($(auth_backup_port_id).val()=='1812')
$(auth_backup_port_id).val('2083');if($(auth_backup_secret_id).val()=='')
$(auth_backup_secret_id).val('radsec');}else{if($(auth_port_id).val()=='2083')
$(auth_port_id).val('1812');if($(auth_secret_id).val()=='radsec')
$(auth_secret_id).val('');if($(auth_backup_port_id).val()=='2083')
$(auth_backup_port_id).val('1812');if($(auth_backup_secret_id).val()=='radsec')
$(auth_backup_secret_id).val('');}}
function radius_dae_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var dae_enable_rowid='#cbi-wireless-'+radio_idx+'-dae_enable';var dae_client_rowid='#cbi-wireless-'+radio_idx+'-dae_client';var dae_port_rowid='#cbi-wireless-'+radio_idx+'-dae_port';var dae_secret_rowid='#cbi-wireless-'+radio_idx+'-dae_secret';if(_enabled){var dae_client_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_client';var dae_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_port';var dae_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_secret';$(dae_client_id).change(function(){validate_radius_dae(radio_idx);});$(dae_port_id).change(function(){validate_radius_dae(radio_idx);});$(dae_secret_id).change(function(){validate_radius_dae(radio_idx);});$(dae_client_rowid).show();$(dae_port_rowid).show();$(dae_secret_rowid).show();}else{var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';$(dae_enable_id).attr('checked',false);$(dae_client_rowid).hide();$(dae_port_rowid).hide();$(dae_secret_rowid).hide();}
validate_radius_dae(radio_idx);}
function isolate_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var mcastenhance_id='#cbid\\.wireless\\.'+radio_idx+'\\.multicast_to_unicast';var proxy_arp_id='#cbid\\.wireless\\.'+radio_idx+'\\.proxy_arp';var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var nbh_val=$(network_behavior_id).val();if(_enabled){$(mcastenhance_id).prop('checked',false);$(proxy_arp_id).prop('checked',false);}else{if(nbh_val!=="dynamic_vlan"){$(mcastenhance_id).prop('checked',true);}
if(nbh_val==="wan"||nbh_val==="vlan"){$(proxy_arp_id).prop('checked',true);}}}
function macfilter_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var macfilter_policy_row_id='#cbi-wireless-'+radio_idx+'-macfilter';var maclist_row_id='#cbi-wireless-'+radio_idx+'-maclist';var macfilter_policy_id='#cbid\\.wireless\\.'+radio_idx+'\\.macfilter';var maclist_id='#cbid\\.wireless\\.'+radio_idx+'\\.maclist';if(_enabled){$(macfilter_policy_id).removeAttr('disabled');$(maclist_id).removeAttr('disabled');$(macfilter_policy_row_id).show();$(maclist_row_id).show();}else{$(macfilter_policy_row_id).hide();$(maclist_row_id).hide();$(macfilter_policy_id).attr('disabled','disabled');$(maclist_id).attr('disabled','disabled');$(macfilter_policy_id).val('');$(maclist_id).val('');}}
function radius_mac_acl_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var dynamic_option_id='#cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan';var dynamic_option='<option id="cbi-wireless-'+radio_idx+'-network_behavior-dynamic_vlan" value="dynamic_vlan">'+_('Dynamic VLAN')+'</option>';var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';var nbh_val=$(network_behavior_id).val();var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';var encryption_val=$(encryption_id).val();var dae_enable_id=$('#cbi-wireless-'+radio_idx+'-dae_enable');var radius_auth_backup=$('#cbi-wireless-'+radio_idx+'-radius_auth_enable2');var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';var key_method_val=$(key_method_id).val();var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radsec_enable';var radsec_enable_rowid=$('#cbi-wireless-'+radio_idx+'-radsec_enable');$(dynamic_option_id).remove();if(_enabled||(encryption_val=='wpa'||encryption_val=='wpa2'||encryption_val=='wpa3'||encryption_val=='wpa3-mixed'||encryption_val=='wpa3-192')||(encryption_val=='psk2'&&key_method_val=='dpsk')){$(network_behavior_id).append(dynamic_option);dae_enable_id.show();radius_dae_enable_change(true,ssid_id);radsec_enable_rowid.show();radius_radsec_enable_change($(radsec_enable_id).is(':checked'),ssid_id);radius_auth_backup.show();radius_auth_backup_enable_change(true,ssid_id);$('#cbi-wireless-'+radio_idx+'-auth_server').show();$('#cbi-wireless-'+radio_idx+'-auth_port').show();$('#cbi-wireless-'+radio_idx+'-auth_secret').show();$('#cbi-wireless-'+radio_idx+'-nasid').show();}else{dae_enable_id.hide();radius_dae_enable_change(false,ssid_id);radsec_enable_rowid.hide();radius_radsec_enable_change($(radsec_enable_id).is(':checked'),ssid_id);radius_auth_backup.hide();radius_auth_backup_enable_change(false,ssid_id);$('#cbi-wireless-'+radio_idx+'-auth_server').hide();$('#cbi-wireless-'+radio_idx+'-auth_port').hide();$('#cbi-wireless-'+radio_idx+'-auth_secret').hide();$('#cbi-wireless-'+radio_idx+'-nasid').hide();}
$(network_behavior_id).val(nbh_val);}
function radius_auth_backup_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var auth_backup_server_rowid='#cbi-wireless-'+radio_idx+'-auth_server2';var auth_backup_port_rowid='#cbi-wireless-'+radio_idx+'-auth_port2';var auth_backup_secret_rowid='#cbi-wireless-'+radio_idx+'-auth_secret2';var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radsec_enable';if(_enabled){var auth_backup_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server2';var auth_backup_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port2';var auth_backup_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret2';$(auth_backup_server_id).change(function(){validate_radius_backup(radio_idx);});$(auth_backup_port_id).change(function(){validate_radius_backup(radio_idx);});$(auth_backup_secret_id).change(function(){validate_radius_backup(radio_idx);});$(auth_backup_server_rowid).show();$(auth_backup_port_rowid).show();$(auth_backup_secret_rowid).show();if($(radsec_enable_id).is(':checked')){if($(auth_backup_port_id).val()=='1812')
$(auth_backup_port_id).val('2083');if($(auth_backup_secret_id).val()=='')
$(auth_backup_secret_id).val('radsec');}else{if($(auth_backup_port_id).val()=='2083')
$(auth_backup_port_id).val('1812');if($(auth_backup_secret_id).val()=='radsec')
$(auth_backup_secret_id).val('');}}else{var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_auth_enable2';$(radius_auth_backup_enable_id).attr('checked',false);$(auth_backup_server_rowid).hide();$(auth_backup_port_rowid).hide();$(auth_backup_secret_rowid).hide();}}
function radius_acct_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var radius_acct_backup=$('#cbi-wireless-'+radio_idx+'-acct_enable2');var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radsec_enable';if(_enabled){$('#cbi-wireless-'+radio_idx+'-acct_server').show();$('#cbi-wireless-'+radio_idx+'-acct_port').show();$('#cbi-wireless-'+radio_idx+'-acct_secret').show();$('#cbi-wireless-'+radio_idx+'-acct_interval').show();radius_acct_backup.show();radius_acct_backup_enable_change(true,ssid_id);}else{$('#cbi-wireless-'+radio_idx+'-acct_server').hide();$('#cbi-wireless-'+radio_idx+'-acct_port').hide();$('#cbi-wireless-'+radio_idx+'-acct_secret').hide();$('#cbi-wireless-'+radio_idx+'-acct_interval').hide();radius_acct_backup.hide();radius_acct_backup_enable_change(false,ssid_id);}
if($(radsec_enable_id).is(':checked')){var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';$('#cbid\\.wireless\\.'+radio_idx+'\\.acct_server').val($(auth_server_id).val());$('#cbid\\.wireless\\.'+radio_idx+'\\.acct_port').val($(auth_port_id).val());$('#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret').val($(auth_secret_id).val());}}
function radius_acct_backup_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var auth_acct_backup_server_rowid='#cbi-wireless-'+radio_idx+'-acct_server2';var auth_acct_backup_port_rowid='#cbi-wireless-'+radio_idx+'-acct_port2';var auth_acct_backup_secret_rowid='#cbi-wireless-'+radio_idx+'-acct_secret2';var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radsec_enable';if(_enabled){$(auth_acct_backup_server_rowid).show();$(auth_acct_backup_port_rowid).show();$(auth_acct_backup_secret_rowid).show();}else{var radius_auth_acct_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';$(radius_auth_acct_backup_enable_id).attr('checked',false);$(auth_acct_backup_server_rowid).hide();$(auth_acct_backup_port_rowid).hide();$(auth_acct_backup_secret_rowid).hide();}
if($(radsec_enable_id).is(':checked')){var auth_acct_backup_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_port2';var auth_acct_backup_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_secret2';if($(auth_acct_backup_port_id).val()=='1813')
$(auth_acct_backup_port_id).val('2083');if($(auth_acct_backup_secret_id).val()=='')
$(auth_acct_backup_secret_id).val('radsec');}}
function radius_change(flag,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var radius_mac_acl_row_id='#cbi-wireless-'+radio_idx+'-radius_mac_acl';var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';var dae_enable_rowid='#cbi-wireless-'+radio_idx+'-dae_enable';var radius_field_optional=function(){return!$(radius_mac_acl_id).is(':checked');};if(flag=='show'){$(radius_mac_acl_row_id).show();}else{$(radius_mac_acl_row_id).hide();$(radius_mac_acl_id).attr('checked',false);clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_server');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_port');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.nasid');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_server2');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_port2');clear_validate_error('#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret2');}
radius_mac_acl_change($(radius_mac_acl_id).is(':checked'),ssid_id);}
function hs20_enable_change(_enabled,ssid_id){var radio_idx=radio_iface+'_'+ssid_id;var pre_vap='#cbi-wireless-'+radio_idx+'-';var hs20_internet_rowid=pre_vap+'iw_internet';var hs20_access_network_type_rowid=pre_vap+'iw_access_network_type';var hs20_venue_group_rowid=pre_vap+'iw_venue_group';var hs20_venue_type_rowid=pre_vap+'iw_venue_type';var hs20_venue_name_rowid=pre_vap+'iw_venue_name';var hs20_roaming_consortium_rowid=pre_vap+'iw_roaming_consortium';var hs20_ipv4_type_availability_rowid=pre_vap+'iw_ipaddr_ipv4_type_availability';var hs20_ipv6_type_availability_rowid=pre_vap+'iw_ipaddr_ipv6_type_availability';var hs20_nai_realm_rowid=pre_vap+'iw_nai_realm';var hs20_domain_name_rowid=pre_vap+'iw_domain_name';var hs20_anqp_3gpp_cell_net_rowid=pre_vap+'iw_anqp_3gpp_cell_net';var hs20_hessid=pre_vap+'hessid';var hs20_venue_url=pre_vap+'iw_venue_url';var hs20_network_auth_type=pre_vap+'network_auth_type';var hs20_oper_friendly_name=pre_vap+'hs20_oper_friendly_name';var hs20_operating_class=pre_vap+'hs20_operating_class';var hs20_iw_portal_enable=pre_vap+'iw_portal_enable';var hs20_iw_portal_url=pre_vap+'iw_portal_url';var hs20_iw_portal_wall=pre_vap+'iw_portal_wall';if(_enabled){$(hs20_internet_rowid).show();$(hs20_access_network_type_rowid).show();$(hs20_venue_group_rowid).show();$(hs20_venue_type_rowid).show();$(hs20_venue_name_rowid).show();$(hs20_roaming_consortium_rowid).show();$(hs20_ipv4_type_availability_rowid).show();$(hs20_ipv6_type_availability_rowid).show();$(hs20_nai_realm_rowid).show();$(hs20_domain_name_rowid).show();$(hs20_anqp_3gpp_cell_net_rowid).show();$(hs20_hessid).show();$(hs20_venue_url).show();$(hs20_network_auth_type).show();$(hs20_oper_friendly_name).show();$(hs20_operating_class).show();$(hs20_iw_portal_enable).show();}else{var hs20_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs20';$(hs20_enable_id).attr('checked',false);$(hs20_internet_rowid).hide();$(hs20_access_network_type_rowid).hide();$(hs20_venue_group_rowid).hide();$(hs20_venue_type_rowid).hide();$(hs20_venue_name_rowid).hide();$(hs20_roaming_consortium_rowid).hide();$(hs20_ipv4_type_availability_rowid).hide();$(hs20_ipv6_type_availability_rowid).hide();$(hs20_nai_realm_rowid).hide();$(hs20_domain_name_rowid).hide();$(hs20_anqp_3gpp_cell_net_rowid).hide();$(hs20_hessid).hide();$(hs20_venue_url).hide();$(hs20_network_auth_type).hide();$(hs20_oper_friendly_name).hide();$(hs20_operating_class).hide();$(hs20_iw_portal_enable).hide();$(hs20_iw_portal_url).hide();$(hs20_iw_portal_wall).hide();}
cbi_d_update('cbid.wireless.'+radio_idx+'.hs20');}
function change_hwmode(){var hwmode=document.getElementById('cbid.wireless.'+radio_iface+'.hwmode');var ht_mode=document.getElementById('cbid.wireless.'+radio_iface+'.htmode');var mode_val=$(hwmode).val();var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var op_mode=$(mode_id).val();var enable_ofdma=document.getElementById('cbid.wireless.'+radio_iface+'._ofdma');if(mode_val=='11axa'||mode_val=='11axg'){$(enable_ofdma).attr('disabled','disabled');$(enable_ofdma).attr('checked','checked');}
var mesh_enable='#cbid\\.wireless\\.wmesh\\.disabled';for(i=1;i<max_ssids+1;i++){var radio_idx=radio_iface+'_'+i;var wmm_id=document.getElementById('cbid.wireless.'+radio_idx+'.wmm');var ht_mode_val=$(ht_mode).val();if(mode_val=='11a'||mode_val=='11g'){if(!mgmt_enabled){$(wmm_id).removeAttr('disabled');}}else{$(wmm_id).attr('disabled','disabled');$(wmm_id).attr('checked','checked');}
$(ht_mode).val(ht_mode_val);}
var band=mode_val;var txrate=current_datarate;var rate_id=document.getElementById('cbid.wireless.'+radio_iface+'.data_rate');show_datarate(band,txrate,rate_id);if(current_band=='5'){var old_mode=$(ht_mode).val();var prev_data=$(ht_mode).data('previous');$(ht_mode).empty();$(ht_mode).append('<option value=\'20\'>20MHz</option>');if(mode_val!='11a'){$(ht_mode).append('<option value=\'40\'>40MHz</option>');}
if(mode_val=='11ac'||mode_val=='11axa'){$(ht_mode).append('<option value=\'80\'>80MHz</option>');if(is_EAP104&&country_code!='IN'){$(ht_mode).append('<option value=\'160\'>160MHz</option>');}}else{if(old_mode=='80'){$(ht_mode).val('20');}}
if(!prev_data||!$(ht_mode).find('option[value=\''+old_mode+'\']')[0]){old_mode='20';}
$(ht_mode).val(old_mode);$(ht_mode).data('previous',old_mode);}}
var loaded=0;var cnt=0;function load_ssid(ssid_id,i){if(root_user=='false'&&msp_disabled=='false'){var lc_enabled_id="1";if(lc_enabled_ids.length!=0||lc_enabled_ids.length!=undefined){lc_enabled_id=lc_enabled_ids[0];}
if(lc_enabled_id!=="1"){$('#SSID_tab_1').removeClass('active');$('#SSID1').removeClass('active');$('#SSID_tab_'+lc_enabled_id).addClass('active');$('#SSID'+lc_enabled_id).addClass('active');}
load_local_configurable_ssid(ssid_id);}
(function(ssid_id,i){var radio_idx=radio_iface+'_'+ssid_id;$.get(ssid_url+'/'+ssid_id,null,function(data){loaded++;if(loaded==total_ssids_added){$('#btn_remove_ssid').removeAttr('disabled');$('#btn_remove_ssid').attr('data-original-title',_('Remove selected SSID'));}
$('#spinner'+i).removeClass('icon-spin');$('.spinner-container'+i).hide();$('#SSID'+i).append(data);$('#SSID_tab_'+i).click(function(){$('[data-rel=tooltip]').tooltip();var tmp_arr=(this.id).split('_');if(tmp_arr[2]=='1'){$('#btn_remove_ssid').hide();}else{$('#btn_remove_ssid').show();}});cbi_d_update('cbid.wireless.'+radio_idx+'.disabled');var vap_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.disabled';$(vap_enable_id).change(function(){vap_enable_change(ssid_id);});vap_enable_change(ssid_id,false,true);var isolate_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.isolate';isolate_enable_change($(isolate_enabled_id).is(':checked'),ssid_id);$(isolate_enabled_id).change(function(){isolate_enable_change($(isolate_enabled_id).is(':checked'),ssid_id);});var encryption_id='#cbid\\.wireless\\.'+radio_idx+'\\.encryption';encry_change(ssid_id);$(encryption_id).change(function(){encry_change(ssid_id);});var key_method_id='#cbid\\.wireless\\.'+radio_idx+'\\.key_method';key_method_change(ssid_id);$(key_method_id).change(function(){key_method_change(ssid_id);});capwap_tunnel_split(ssid_id,'lock');var macfilter_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.macfilter_enable';macfilter_enable_change($(macfilter_enabled_id).is(':checked'),ssid_id);var macfilter_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.macfilter_enable';$(macfilter_enabled_id).change(function(){macfilter_enable_change($(macfilter_enabled_id).is(':checked'),ssid_id);});var radius_mac_acl_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_mac_acl';$(radius_mac_acl_id).change(function(){radius_mac_acl_change($(radius_mac_acl_id).is(':checked'),ssid_id);});var radius_auth_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radius_auth_enable2';$(radius_auth_backup_enable_id).change(function(){radius_auth_backup_enable_change($(radius_auth_backup_enable_id).is(':checked'),ssid_id);});var dae_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.dae_enable';$(dae_enable_id).change(function(){radius_dae_enable_change($(dae_enable_id).is(':checked'),ssid_id);});var radius_acct_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable';$(radius_acct_enable_id).change(function(){radius_acct_enable_change($(radius_acct_enable_id).is(':checked'),ssid_id);});var radius_acct_backup_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.acct_enable2';$(radius_acct_backup_enable_id).change(function(){radius_acct_backup_enable_change($(radius_acct_backup_enable_id).is(':checked'),ssid_id);});var auth_server_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_server';var auth_port_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_port';var auth_secret_id='#cbid\\.wireless\\.'+radio_idx+'\\.auth_secret';var nasid_id='#cbid\\.wireless\\.'+radio_idx+'\\.nasid';$(auth_server_id).change(function(){clear_validate_error(auth_server_id);});$(auth_port_id).change(function(){clear_validate_error(auth_port_id);});$(auth_secret_id).change(function(){clear_validate_error(auth_secret_id);});$(nasid_id).change(function(){clear_validate_error(nasid_id);});var radsec_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.radsec_enable';$(radsec_enable_id).change(function(){radius_radsec_enable_change($(radsec_enable_id).is(':checked'),ssid_id);});var network_behavior_id='#cbid\\.wireless\\.'+radio_idx+'\\.network_behavior';network_behavior_change(radio_idx,ssid_id);$(network_behavior_id).change(function(){network_behavior_change(radio_idx,ssid_id);});var limit_up_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';limit_up_enable_change($(limit_up_enabled_id).is(':checked'),ssid_id);var limit_up_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_up_enable';$(limit_up_enabled_id).change(function(){limit_up_enable_change($(limit_up_enabled_id).is(':checked'),ssid_id);});var limit_down_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';limit_down_enable_change($(limit_down_enabled_id).is(':checked'),ssid_id);var limit_down_enabled_id='#cbid\\.wireless\\.'+radio_idx+'\\.limit_down_enable';$(limit_down_enabled_id).change(function(){limit_down_enable_change($(limit_down_enabled_id).is(':checked'),ssid_id);});var hs20_enable_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs20';$(hs20_enable_id).change(function(){hs20_enable_change($(hs20_enable_id).is(':checked'),ssid_id);});var walled_id='#cbid\\.wireless\\.'+radio_idx+'\\.hs_wall';$(walled_id).change(function(){validateWall(radio_id+'_'+ssid_id);});if(loaded==total_ssids_enabled){for(i=1;i<=max_ssids;i++){disabled_items(radio_id,i,'ap');if(root_user=='false'&&msp_disabled=='false'){load_local_configurable_ssid(i);}}
set_btn_state();change_opmode();change_hwmode();$(mesh_enable).change();if($('#SSID_tab_1').hasClass('active')){$('#SSID_tab_1').click();}}
var $ssid_title=$('#cbid\\.wireless\\.'+radio_idx+'\\.ssid');var $ssid_tab=$('[href="#SSID'+ssid_id+'"]');var ssid_tab_html='<span>'+$ssid_title.val()+'</span>&nbsp;(SSID'+ssid_id+')';$ssid_tab.html(ssid_tab_html);$('#SSID_tab_'+ssid_id).show();}).done(function(data){cbi_init();cnt++;if(cnt<=created_ssid_ids.length){load_ssid(created_ssid_ids[cnt-1],cnt);}});})(ssid_id,cnt);}
function sort_select_option(_select_id){var tmp_options=$(_select_id+' option');var arr=tmp_options.map(function(_,o){return{t:$(o).text(),v:o.value,_id:o.id};}).get();arr.sort(function(o1,o2){return o1.t>o2.t?1:o1.t<o2.t?-1:0;});tmp_options.each(function(i,o){o.value=arr[i].v;$(o).text(arr[i].t);o.id=arr[i]._id;});}
function verify_beacon(){clear_validate_error($(beacon_id)[0]);if($(beacon_id).val()==''||(!is_in_range($(beacon_id).val(),beacon_min,beacon_max))){set_err_msg($(beacon_id),true,_('Allowed values are integers between %d and %d, inclusive.').format(beacon_min,beacon_max));return false;}
return true;}
function verify_mesh_id(){clear_validate_error($(mesh_id)[0]);if($(mesh_id).attr('disabled')=='disabled'||$(mesh_id).length==0){return true;}
if($(mesh_id).val()==''||(!rangelength($(mesh_id).val(),1,200))){set_err_msg($(mesh_id),true,_('value between %d and %d characters').format(1,200));return false;}
return true;}
function verify_mesh_key(){clear_validate_error($(mesh_key)[0]);if($(mesh_key).attr('disabled')=='disabled'||$(mesh_key).length==0){return true;}
if($(mesh_enable).is(':checked')){if($(mesh_key).val()==''||(!wpakey($(mesh_key).val()))){set_err_msg($(mesh_key),true,_('Not a valid WPA key! Value must be between 8 and 63 ASCII (letters and numbers) characters long or 64 Hex characters.'));return false;}}
return true;}
function addHandler(){$(beacon_id).change(function(){verify_beacon();});$(mesh_id).change(function(){verify_mesh_id();});$(mesh_key).change(function(){verify_mesh_key();});}
function before_submit(){channel_id='cbid\\.wireless\\.'+radio_iface+'\\.channel';if(!validate_form()){cbi_show_form_error();window.document.body.scrollTop=0;window.document.documentElement.scrollTop=0;return false;}else{if(cbi_validate_form(document.getElementById('cbi'),'Some fields are invalid, please see messages below!')){for(var i=1;i<=total_ssids_added;i++){disabled_items(radio_id,i,'sta_mode');$('#cbid\\.wireless\\.'+radio_iface+'_'+i+'\\.CAPWAP_tunnel').removeAttr('disabled');$('#cbid\\.wireless\\.'+radio_iface+'_'+i+'\\._s_zone_').removeAttr('disabled');}}
$('#'+channel_id).prop('disabled',false);$('#tx_slider').slider('enable');$('#cbid\\.wireless\\.'+radio_iface+'\\.txpower').removeAttr('disabled');return true;}}
function enable_DFS_channel(flag){if(dfs_channel_by_mesh){$("#table_channel").find("div[id$='DFS_required']").each(function(){if($(this).text()=="Yes"){if(flag==1){$(this).closest('tr').show();}
else{$(this).closest('tr').hide();}}})}}
window.onload=function(){addHandler();};$(function(){$("li[id^='SSID_tab']").hide();$('#SSID_tab_1').show();$('#SSID_tab_1').addClass('active');$('#SSID1').addClass('active');channel_id='cbid\\.wireless\\.'+radio_iface+'\\.channel';beacon_id='#cbid\\.wireless\\.'+radio_iface+'\\.beacon_int';$('#select_all').change(function(){var tbl_name='#table_channel';$(tbl_name+' tbody:checkbox').prop('checked',$(this).is(':checked'));var checkboxes=$(this).closest('table').find('.region_ct');checkboxes.prop('checked',$(this).is(':checked'));});$(document).on('click','.region_ct',function(){var checkedLength=$('.region_ct:checked').length;var checkboxLength=$('.region_ct').length;$('#select_all').prop('checked',checkedLength==checkboxLength);});$('#btn_wifi_frequency').click(function(){$('#wifi_frequency_modal').modal('hide');save_channel();});$('#close_frequency_window').click(function(){$('#wifi_frequency_modal').modal('hide');save_channel();});access_permission();wifi_channel();var tx_name='cbid.wireless.'+radio_iface+'.txpower';$('#cbid\\.wireless\\.'+radio_iface+'\\.txpower > option').each(function(){if(parseInt(this.value)>parseInt(txpwr_list_limit)){$(this).remove();}})
var default_specific_channel_id='cbi-wireless-'+radio_iface+'-channel-unknown';var new_channel_specific_option='cbi-wireless-'+radio_iface+'-channel-'+channel_val;var channel_specific_option='';if(channel_val=='auto'){channel_specific_option='<option id="'+default_specific_channel_id+'" value="unknown">Specific Frequency</option>';$('#frequency_btn_'+radio_iface).val('Auto');}else{channel_specific_option='<option id="'+new_channel_specific_option+'" value="'+channel_val+'">Specific Frequency</option>';if(channel_val.search('-')>=0){$('#frequency_btn_'+radio_iface).val('Auto');}else{var selected_freq_full=$('#cbi-wifi_channel-'+channel_val+'-frequency').text();var selected_freq_full_arr=selected_freq_full.split(' ');$('#frequency_btn_'+radio_iface).val(channel_val+' ('+(selected_freq_full_arr[0]/1000)+' GHz)');}}
var channel_auto_option='<option id="cbi-wireless-'+radio_iface+'-channel-auto" value="auto">Auto</option>';$('#'+channel_id).empty();$('#'+channel_id).append(channel_auto_option);$('#'+channel_id).append(channel_specific_option);if(channel_val!='auto'){$('#'+new_channel_specific_option).prop('selected','selected');}
$('#cbi').submit(function(){return before_submit();});generate_wme_table();$('#btn_wifi_wme_save').click(function(){save_wme_table();});$('#close_wme_window').click(function(){save_wme_table();});$('#cbi-wireless-'+radio_iface+'-tx_streams').addClass('hidden');$('#cbi-wireless-'+radio_iface+'-rx_streams').addClass('hidden');$('#cbid\\.wireless\\.'+radio_iface+'\\.ack').on('change input',function(){set_ack_distance();});$('#'+channel_id).change(function(){set_txpower_list();});if(!bandsteering_allowed){$('#cbid\\.wireless\\.'+radio_iface+'\\.bandsteering').attr('disabled','disabled');}
set_txpower_list();set_ack_distance();$('#btn_add_ssid').attr('disabled','disabled');$('#btn_save').attr('disabled','disabled');$('#btn_apply').attr('disabled','disabled');$(mesh_enable).attr('disabled','disabled');$('#btn_add_ssid').click(function(){add_ssid();});$('#btn_wifi_scan').click(function(){scan();});$('#btn_wifi_aiming_stop').attr('disabled','disabled');$('#btn_wifi_aiming_start').click(function(){aiming_stop_Tid=-1;aiming_timeout_id=setTimeout(send_aiming_request,1*1000);$('#btn_wifi_aiming_start').attr('disabled','disabled');$('#aiming_mode').attr('disabled','disabled');$('#btn_wifi_aiming_stop').removeAttr('disabled');});$('#btn_wifi_aiming_stop').click(function(){$('#spinner_aiming_container').hide();clearTimeout(aiming_timeout_id);aiming_stop_Tid=aiming_timeout_id;$('#btn_wifi_aiming_start').removeAttr('disabled');$('#aiming_mode').removeAttr('disabled');$('#btn_wifi_aiming_stop').attr('disabled','disabled');});$('#close_aiming_window').click(function(){$('#spinner_aiming_container').hide();clearTimeout(aiming_timeout_id);aiming_stop_Tid=aiming_timeout_id;$('#btn_wifi_aiming_start').removeAttr('disabled');$('#aiming_mode').removeAttr('disabled');$('#btn_wifi_aiming_stop').attr('disabled','disabled');});$('#btn_remove_ssid').click(function(){remove_ssid();});$('#btn_remove_ssid').attr('disabled','disabled');$('#btn_remove_ssid').attr('data-original-title',_('Loading SSIDs, please wait a moment.'));$('#btn_add_ssid').attr('data-original-title',_('Loading SSIDs, please wait a moment.'));total_ssids_added=total_ssids_enabled;if(created_ssid_ids.length==0||created_ssid_ids.length==undefined){$('#ssidTabContent').html(_('No VAP is created.'));set_btn_state();}else{$('#ssidTabContent').html();}
if(root_user=='false'&&msp_disabled=='false'&&(lc_enabled_ids.length==0||lc_enabled_ids.length==undefined)){$('#ssidTabContent').html(_('No Local Configurable SSIDs available.'));}else{$('#ssidTabContent').html();}
cnt=1;load_ssid(created_ssid_ids[cnt-1],cnt);var status_id=document.getElementById('cbid.wireless.'+radio_iface+'.disabled');$(status_id).click(function(){if($(status_id).is(':checked')){$('#'+radio_iface+'_1_wan_change_notify').addClass('hidden');$('#'+radio_iface+'_1_reset_inet_src').val('0');var op_mode=$('#cbid\\.wireless\\.'+radio_iface+'\\.mode').val();if(op_mode.indexOf('sta')<0){$('#'+radio_iface+'_1_set_inet_src').val('0');}else{$('#'+radio_iface+'_1_set_inet_src').val('1');}
$('#'+radio_iface+'_1_wan_notify').removeClass('hidden');}else{$('#'+radio_iface+'_1_wan_change_notify').removeClass('hidden');$('#'+radio_iface+'_1_reset_inet_src').val('1');$('#'+radio_iface+'_1_set_inet_src').val('1');$('#'+radio_iface+'_1_wan_notify').addClass('hidden');}});var mode_id=document.getElementById('cbid.wireless.'+radio_iface+'.mode');var hwmode=document.getElementById('cbid.wireless.'+radio_iface+'.hwmode');$(document.getElementById('cbid.wireless.'+radio_iface+'.htmode')).data('previous','valid');$(mode_id).change(function(){if($(mode_id).val().indexOf('sta')<0){$('#ssid_tabs li').removeClass('active');$('#ssidTabContent .tab-pane').removeClass('active');var lc_enabled_id="1";if(root_user=='false'&&msp_disabled=='false'&&(lc_enabled_ids.length!=0&&lc_enabled_ids.length!=undefined)){lc_enabled_id=lc_enabled_ids[0];}
$('#SSID_tab_'+lc_enabled_id).addClass('active');$('#SSID'+lc_enabled_id).addClass('active');}
change_opmode();change_hwmode();});$(hwmode).change(change_hwmode);var tx=document.getElementById('cbid.wireless.'+radio_iface+'.tx_streams');var rx=document.getElementById('cbid.wireless.'+radio_iface+'.rx_streams');var select_tx=$(tx);var select_rx=$(rx);$(tx).change(function(){set_txpower_list();if(select_tx[0].selectedIndex==1){$(rx).children('option[value="1"]').hide();select_rx[0].selectedIndex=1;}else{$(rx).children('option[value="1"]').show();}});$(tx).change();var id=document.getElementById('cbid.wireless.'+radio_iface+'.ack');var max_tmp=255;var min_tmp=32;$('#ack_slider').slider({orientation:'horizontal',range:'min',max:max_tmp,min:min_tmp,value:$(id).val(),slide:function(event,ui){$(id).val(ui.value);clear_validate_error('#cbid\\.wireless\\.'+radio_iface+'\\.ack');set_ack_distance();}});$(id).change(function(){if($(id).val().match(/^-?[0-9]+$/)){$('#ack_slider').slider('value',$(id).val());}});$('#wmm_save').click(function(){if(($('#ac_bk_cwmin').val()<1)||($('#ac_bk_cwmin').val()>10)){return false;}
if(($('#ac_bk_cwmax').val()<1)||($('#ac_bk_cwmax').val()>10)){return false;}
if(($('#ac_bk_aifsn').val()<1)||($('#ac_bk_aifsn').val()>7)){return false;}
if(($('#ac_bk_txop').val()<0)||($('#ac_bk_txop').val()>256)){return false;}
if(($('#ac_be_cwmin').val()<1)||($('#ac_be_cwmin').val()>10)){return false;}
if(($('#ac_be_cwmax').val()<1)||($('#ac_be_cwmax').val()>10)){return false;}
if(($('#ac_be_aifsn').val()<1)||($('#ac_be_aifsn').val()>7)){return false;}
if(($('#ac_be_txop').val()<0)||($('#ac_be_txop').val()>256)){return false;}
if(($('#ac_vi_cwmin').val()<1)||($('#ac_vi_cwmin').val()>10)){return false;}
if(($('#ac_vi_cwmax').val()<1)||($('#ac_vi_cwmax').val()>10)){return false;}
if(($('#ac_vi_aifsn').val()<1)||($('#ac_vi_aifsn').val()>7)){return false;}
if(($('#ac_vi_txop').val()<0)||($('#ac_vi_txop').val()>256)){return false;}
if(($('#ac_vo_cwmin').val()<1)||($('#ac_vo_cwmin').val()>10)){return false;}
if(($('#ac_vo_cwmax').val()<1)||($('#ac_vo_cwmax').val()>10)){return false;}
if(($('#ac_vo_aifsn').val()<1)||($('#ac_vo_aifsn').val()>7)){return false;}
if(($('#ac_vo_txop').val()<0)||($('#ac_vo_txop').val()>256)){return false;}
$('#wmm_data').submit();$('#wmm_set').modal('hide');});function ht_ch_ctrl(){var op_mode=$('#cbid\\.wireless\\.'+radio_iface+'\\.mode').val();if(op_mode.indexOf('sta')>=0){return;}
var ht_mode_val=$(ht_mode).val();if(current_band=='2.4'){if(ht_mode_val==='40'){$('#cbi-wireless-'+radio_iface+'-noscan').show();}else{$('#cbi-wireless-'+radio_iface+'-noscan').hide();}}
wifi_channel();enable_DFS_channel($(mesh_enable).is(':checked')==false);save_channel();}
var ht_mode=document.getElementById('cbid.wireless.'+radio_iface+'.htmode');$(ht_mode).change(ht_ch_ctrl);$(ht_mode).change(set_txpower_list);$(ht_mode).change();if($('#table_channel').length>1){$('#table_channel').tablesorter({sortList:[[1,0]],headers:{0:{sorter:false},3:{sorter:false},4:{sorter:false}}});}
var mesh_encryption='#cbid\\.wireless\\.wmesh\\.encryption';var mesh_network='#cbid\\.wireless\\.wmesh\\.network_behavior';var mesh_id_row='#cbi-wireless-wmesh-mesh_id';var mesh_encryption_row='#cbi-wireless-wmesh-encryption';var mesh_key_row='#cbi-wireless-wmesh-_wpa_key';var mesh_network_row='#cbi-wireless-wmesh-network_behavior';var mesh_network_name_row='#cbi-wireless-wmesh-network_name';$(mesh_encryption).change(function(){$(mesh_key_row).hide();$(mesh_key).attr('disabled','disabled');if($(this).val()=='sae'){$(mesh_key).removeAttr('disabled');$(mesh_key_row).show();}});$(mesh_network).change(function(){$(mesh_network_name_row).hide();if($(this).val()=='route'){$(mesh_network_name_row).show();}});if(total_ssids_added==max_ssids){$(mesh_enable).attr('checked',false);$(mesh_enable).attr('disabled','disabled');}
if(!$(mesh_enable).is(':checked')){$(mesh_id_row).hide();$(mesh_encryption_row).hide();$(mesh_network_row).hide();$(mesh_key_row).hide();$(mesh_network_name_row).hide();}else{$(mesh_encryption).change();$(mesh_network).change();}
$(mesh_enable).change(function(){$(mesh_id_row).hide();$(mesh_encryption_row).hide();$(mesh_network_row).hide();$(mesh_key_row).hide();$(mesh_network_name_row).hide();var _max_ssids=default_max_ssids;if($(this).is(':checked')){_max_ssids=default_max_ssids-1;$(mesh_id).removeAttr('disabled');$(mesh_id_row).show();$(mesh_encryption_row).show();$(mesh_network_row).show();$(mesh_encryption).change();$(mesh_network).change();enable_DFS_channel(0);}
else{$(mesh_id).attr('disabled','disabled');enable_DFS_channel(1);}
save_channel()
max_ssids=_max_ssids;set_btn_state();});});function show_datarate(band,txrate,rate_id){$(rate_id).empty();$(rate_id).append('<option value="auto">Auto</option>');if(band==='11b'||band==='11g'||band==='11ng'||band==='11axg'){$(rate_id).append('<option value="0">1M</option>');$(rate_id).append('<option value="1">2M</option>');$(rate_id).append('<option value="2">5.5M</option>');$(rate_id).append('<option value="3">11M</option>');}
if(band==='11ng'||band==='11g'||band==='11na'||band==='11a'||band==='11ac'||band==='11axg'||band==='11axa'){$(rate_id).append('<option value="4">6M</option>');$(rate_id).append('<option value="5">9M</option>');$(rate_id).append('<option value="6">12M</option>');$(rate_id).append('<option value="7">18M</option>');$(rate_id).append('<option value="8">24M</option>');$(rate_id).append('<option value="9">36M</option>');$(rate_id).append('<option value="10">48M</option>');$(rate_id).append('<option value="11">54M</option>');}
if(band==='11ng'||band==='11na'||band==='11ac'||band==='11axg'||band==='11axa'){$(rate_id).append('<option value="12">MCS0</option>');$(rate_id).append('<option value="13">MCS1</option>');$(rate_id).append('<option value="14">MCS2</option>');$(rate_id).append('<option value="15">MCS3</option>');$(rate_id).append('<option value="16">MCS4</option>');$(rate_id).append('<option value="17">MCS5</option>');$(rate_id).append('<option value="18">MCS6</option>');$(rate_id).append('<option value="19">MCS7</option>');if(max_tx_streams>1){$(rate_id).append('<option value="20">MCS8</option>');$(rate_id).append('<option value="21">MCS9</option>');$(rate_id).append('<option value="22">MCS10</option>');$(rate_id).append('<option value="23">MCS11</option>');$(rate_id).append('<option value="24">MCS12</option>');$(rate_id).append('<option value="25">MCS13</option>');$(rate_id).append('<option value="26">MCS14</option>');$(rate_id).append('<option value="27">MCS15</option>');}
if(max_tx_streams>2){$(rate_id).append('<option value="100">MCS16</option>');$(rate_id).append('<option value="101">MCS17</option>');$(rate_id).append('<option value="102">MCS18</option>');$(rate_id).append('<option value="103">MCS19</option>');$(rate_id).append('<option value="104">MCS20</option>');$(rate_id).append('<option value="105">MCS21</option>');$(rate_id).append('<option value="106">MCS22</option>');$(rate_id).append('<option value="107">MCS23</option>');}}
$(rate_id).val(txrate);}